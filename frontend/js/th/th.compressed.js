(function(){var d=false;var e=/xyz/.test(function(){xyz})?/\b_super\b/:{test:function(){return true}};this.Class=function(){this.type="Class"};Class.define=function(s){if(!s.superclass){s.superclass=Class}var q=s.superclass.prototype,t=s.members||{};d=true;var m=new s.superclass();d=false;if(s.uses){var p=Trait.define({uses:s.uses,_klass_prototype:m,_klass_properties:t});for(var n in p._exports){if(!p._exports.hasOwnProperty(n)){continue}if(t.hasOwnProperty(n)){if(typeof t[n]!="function"){throw new Trait.TraitError(n+" overrides trait method and must be a function.")}}else{t[n]=p._exports[n]}}}for(var l in t){if(!t.hasOwnProperty(l)){continue}m[l]=typeof t[l]=="function"&&typeof q[l]=="function"&&e.test(t[l])?(function(o,u){return function(){var w=this._super;this._super=q[o];var v=u.apply(this,arguments);this._super=w;return v}})(l,t[l]):t[l]}var j=function(){if(!d&&this.init){this.init.apply(this,arguments)}};j.prototype=m;j.constructor=j;j.superclass=s.superclass;j.prototype.type=s.type;j.does=function(v){if(!p){if(j.superclass.does){return j.superclass.does(v)}if(v){return false}return[]}var u=p.does(v);if(j.superclass.does){if(v){return u||j.superclass.does(v)}var w=j.superclass.does(v).concat([]);for(var o=u.length-1;o>=0;o--){if(w.indexOf(u[o])===-1){w.push(u[o])}}return w}return u};if(!j.prototype.hasOwnProperty("does")){j.prototype.does=j.does}return j};function a(j){return Object.prototype.toString.apply(j)==="[object Array]"}function h(j){if(j){return a(j)?j:[j]}return[]}function f(j){if(!j){return{}}var l={};if(!a(j)){l[j]=true;return l}for(var m=j.length-1;m>=0;m--){l[j[m]]=true}return l}function i(m,l){for(var j in l){if(!l.hasOwnProperty(j)){continue}m[j]=l[j]}return m}this.Trait=Class.define({members:{init:function(p){this._subtraits=h(p.uses);this._requires=f(p.requires);this._exports=p.methods?p.methods:{};var m;for(m in this._requires){if(!this._requires.hasOwnProperty(m)){continue}if(this._exports.hasOwnProperty(m)){throw new Trait.TraitError("Trait cannot require and provide the same method "+m)}}var n,j,l,q={};for(l=this._subtraits.length-1;l>=0;l--){n=this._subtraits[l];j=i({},n._exports);if(n._aliases){i(j,n._aliases)}if(n._excludes){for(m in n._excludes){if(!n._excludes.hasOwnProperty(m)){continue}delete j[m];i(q,n._excludes)}}for(m in j){if(!j.hasOwnProperty(m)){continue}if(p._klass_prototype&&p._klass_properties.hasOwnProperty(m)&&typeof p._klass_properties[m]=="function"){continue}if(this._exports.hasOwnProperty(m)){if((!p.methods||!p.methods.hasOwnProperty(m))&&this._exports[m]!=j[m]){throw new Trait.TraitError("Multiple subtraits provide method "+m+" creating a conflict. Exclude all but one of the methods or override the method in the trait/class to resolve.")}continue}this._exports[m]=j[m]}for(m in n._requires){if(!n._requires.hasOwnProperty(m)){continue}if(!this._exports.hasOwnProperty(m)){this._requires[m]=true}}delete n._aliases;delete n._excludes}for(m in q){if(!q.hasOwnProperty(m)){continue}if(!this._exports.hasOwnProperty(m)&&(!p._klass_prototype||(typeof p._klass_prototype[m]!="function"&&typeof p._klass_properties[m]!="function"))){throw new Trait.TraitError("Excluded method "+m+" must be provided by another class or trait.")}}for(m in this._requires){if(!this._requires.hasOwnProperty(m)){continue}if(this._exports.hasOwnProperty(m)){delete this._requires[m]}else{if(p._klass_prototype&&(typeof p._klass_prototype[m]!="function"&&typeof p._klass_properties[m]!="function")){throw new Trait.TraitError("Trait requirement "+m+" not fullfilled by class.")}}}},aliases:function(l){this._aliases=this._aliases||{};for(var j in l){if(!l.hasOwnProperty(j)){continue}if(!this._exports.hasOwnProperty(l[j])){throw new Trait.TraitError("can't alias "+j+" to "+l[j]+" because trait doesn't have that method")}if(this._exports.hasOwnProperty(j)){throw new Trait.TraitError("can't create an alias with name "+j+" because trait natively exports that method")}if(this._requires.hasOwnProperty(j)){throw new Trait.TraitError("can't create an alias with name "+j+" because trait requires method with same name")}this._aliases[j]=this._exports[l[j]]}return this},excludes:function(j){this._excludes=this._excludes||{};j=h(j);for(var l=j.length-1;l>=0;l--){if(!this._exports.hasOwnProperty(j[l])){throw new Trait.TraitError("can't exclude method "+j[l]+" because no such method exists in trait")}this._excludes[j[l]]=true}return this},does:function(o){if(!this._does){this._does=[this].concat(this._subtraits);var n,m,l;for(n=this._subtraits.length-1;n>=0;n--){l=this._subtraits[n].does();for(m=l.length-1;m>=0;m--){if(this._does.indexOf(l[m])===-1){this._does.push(l[m])}}}}if(o){return this._does.indexOf(o)>=0}return this._does},requires:function(j){if(j){return this._requires.hasOwnProperty(j)&&this._requires[j]}return this._requires},subtraits:function(j){if(j){return this._subtraits.indexOf(j)>=0}return this._subtraits},methods:function(j){if(j){return this._exports.hasOwnProperty(j)&&this._exports[j]}return this._exports}}});Trait.define=function(j){return new Trait(j)};Trait.TraitError=Class.define({superclass:Error,members:{init:function(j){this.name="TraitError";this.message=j}}})})();if(!("console" in window)){window.console={log:function(a){}}}if(location.href.indexOf("file:")==0){try{if(netscape.security.PrivilegeManager.enablePrivilege){netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead")}}catch(ex){console.log("Couldn't elevate priviledges to deal with file URLs")}}if(typeof th=="undefined"){th={}}th.browser={IE:!!(window.attachEvent&&!window.opera),Opera:!!window.opera,WebKit:navigator.userAgent.indexOf("AppleWebKit/")>-1,Gecko:navigator.userAgent.indexOf("Gecko")>-1&&navigator.userAgent.indexOf("KHTML")==-1,MobileSafari:!!navigator.userAgent.match(/Apple.*Mobile.*Safari/)};th.fixCanvas=function(a){if(!a.fillText&&a.mozDrawText){a.fillText=function(f,d,h,e){a.translate(d,h);a.mozTextStyle=a.font;a.mozDrawText(f);a.translate(-d,-h)}}if(!a.measureText&&a.mozMeasureText){a.measureText=function(e){if(a.font){a.mozTextStyle=a.font}var d=a.mozMeasureText(e);return{width:d}}}if(a.measureText&&!a.html5MeasureText){a.html5MeasureText=a.measureText;a.measureText=function(e){var d=a.html5MeasureText(e);d.ascent=a.html5MeasureText("m").width;return d}}if(!a.fillText){a.fillText=function(){}}if(!a.measureText){a.measureText=function(){return 10}}return a};th.byId=function(a){return document.getElementById(a)};th.isString=function(a){return !!arguments.length&&a!=null&&(typeof a=="string"||a instanceof String)};th.isArray=function(a){return a&&(a instanceof Array||typeof a=="array")};th.forEach=function(d,j,f){if(!d||!d.length){return}var a=th._getParts(d,f,j);d=a[0];for(var h=0,e=d.length;h<e;++h){a[2].call(a[1],d[h],h,d)}};th._getParts=function(d,e,a){return[th.isString(d)?d.split(""):d,e||this,th.isString(a)?new Function("item","index","array",a):a]};th.xhrGet=function(a){var d=new XMLHttpRequest();d.onreadystatechange=function(){if(d.readyState==4){a.load.apply(a.context,[d.responseText])}};d.open("GET",a.url);d.send(null)};th.remove=function(f,d){var e=[];for(var a=0;a<f.length;a++){if(f[a]!=d){e.push(f[a])}}return e};th.observe=function(f,a,e,d){var h=(d)?function(i){e.apply(d,[i])}:e;f["on"+a]=h};th.trim=String.prototype.trim?function(a){return a.trim()}:function(a){return a.replace(/^\s\s*/,"").replace(/\s\s*$/,"")};th.mixin=function(f,e){if(!f){f={}}for(var d=1,a=arguments.length;d<a;d++){th._mixin(f,arguments[d])}return f};th._mixin_tobj={};th._mixin=function(f,d){for(var a in d){if(th._mixin_tobj[a]===undefined||th._mixin_tobj[a]!=d[a]){f[a]=d[a]}}if(th.browser.IE&&d){var e=d.toString;if(typeof e=="function"&&e!=f.toString&&e!=th._mixin_tobj.toString&&e!="\nfunction toString() {\n    [native code]\n}\n"){f.toString=d.toString}}return f};th.cumulativeOffset=function(d){var a=0,e=0;do{a+=d.offsetTop||0;e+=d.offsetLeft||0;d=d.offsetParent}while(d);return th._returnOffset(e,a)};th._returnOffset=function(d,e){var a=[d,e];a.left=d;a.top=e;return a};th.isPercentage=function(a){return(a.indexOf&&a.indexOf("%")!=-1)};th.isCssPixel=function(a){a=th.trim(a).toLowerCase();return(a.indexOf("px")==a.length-2)};th.isCssLength=function(a){return/^[\d\.]+(em|ex|px|\%|in|cm|mm|pt|pc)$/.test(a)};th.isCssBorderStyle=function(a){return/^(none|hidden|dotted|dashed|solid|double|groove|ridge|inset|outset)$/.test(a)};th.defaultCSSBorder=function(){return{top:{width:0,style:"none",color:"black"},bottom:{width:0,style:"none",color:"black"},left:{width:0,style:"none",color:"black"},right:{width:0,style:"none",color:"black"}}};th.defaultCSSMargin=function(){return{top:0,bottom:0,left:0,right:0}};th.defaultCSSPadding=function(){return{top:0,bottom:0,left:0,right:0}};th.getSpaceDelimitedItems=function(a){return th.parenAwareSplit(" ",a)};th.getCommaDelimitedItems=function(a){return th.parenAwareSplit(",",a)};th.parenAwareSplit=function(j,e){if(j.length!=1){throw"Invalid delimiter passed to parenAwareSplit: '"+j+"'"}var h=[];var d=false;var i;var f="";for(var a=0;a<e.length;a++){i=e[a];if(i==j){if(!d){h.push(th.trim(f));f="";continue}}else{if(i=="("){d=true}else{if(i==")"){d=false}}}f+=i}h.push(th.trim(f));return h};th.whitespace=" \t\n\r";th.isWhitespace=function(d){if(!d||d.length==0){return true}for(var a=0;a<d.length;a++){var e=d.charAt(a);if(th.whitespace.indexOf(e)==-1){return false}}return true};th.measureUsingDOM=function(f,e){if(!document){throw"Can't perform measurements outside of browser"}var a=document.getElementsByTagName("body")[0];var d=document.createElement("div");d.setAttribute("style","position: absolute; visibility:hidden");a.appendChild(d);if(e){f.apply(e,[d])}else{f(d)}a.removeChild(d)};th.measure_cache={};th.safeget=function(d,a){return(d==undefined)?a:d};th.unitRegex=/^([\d\.]+)(em|ex|px|\%|in|cm|mm|pt|pc)$/;th.absoluteUnitRegex=/^([\d\.]+)(px|in|cm|mm|pt|pc)$/;th.isBorderLength=function(a){return(a=="thin"||a=="medium"||a=="thick")};th.convertLengthToPixels=function(d,a){if(th.isBorderLength(d)){return th.convertBorderLengthToPixels(d)}else{if(th.absoluteUnitRegex.test(d)){return th.convertAbsoluteUnitToPixels(d)}}};th.convertBorderLengthToPixels=function(d){if(d===undefined){return 0}var e=d;if(th.measure_cache[e]){return th.measure_cache[e]}var a=undefined;th.measureUsingDOM(function(f){f.setAttribute("style","position: relative; border-left: "+d+" solid black");f.innerHTML="some text";a=f.scrollWidth-f.clientWidth});th.measure_cache[e]=a;return a};th.convertAbsoluteUnitToPixels=function(a,f){var e;if(f===undefined){var d=th.absoluteUnitRegex.exec(a);if(d.length!=3){throw"Passed length "+a+" isn't a CSS absolute unit"}e=d[2];f=Number(d[1])}else{e=a}if(e=="px"){return f}else{if(e=="in"||e=="cm"||e=="mm"||e=="pt"||e=="pc"){return th.measureAbsoluteUnit(f+e)}else{throw"Unsupported unit: "+e}}};th.measureAbsoluteUnit=function(d){if(d===undefined){return 0}var e=d;if(th.measure_cache[e]){return th.measure_cache[e]}var a=undefined;th.measureUsingDOM(function(h){var f=h.getAttribute("style");h.setAttribute("style",f+="; width: "+d);a=h.scrollWidth});th.measure_cache[e]=a;return a};th.convertEmToPixels=function(f,d){var e=f+d;if(th.measure_cache[e]){return th.measure_cache[e]}var a=undefined;th.measureUsingDOM(function(i){var h=i.getAttribute("style");i.setAttribute("style",h+="; font: "+f+"; width: "+d+"em");a=i.scrollWidth});th.measure_cache[e]=a;return a};th.getHierarchyString=function(d){var a="";while(d){var e=d.type;if(d.id){e+="#"+d.id}if(d.className){e+="."+d.className}a=e+=" "+a;d=d.parent}return th.trim(a)};th.isObject=function(a){return a!==undefined&&(a===null||typeof a=="object"||th.isArray(a)||th.isFunction(a))};th.isFunction=(function(){var a=function(d){return d&&(typeof d=="function"||d instanceof Function)};return a})();if(typeof th=="undefined"){th={}}th.CssParser=Class.define({members:{parse:function(d,a){if(!a){a={}}d=d.replace(/\s+/gi," ");th.forEach(this.munge(d,false).split("`b%"),function(e){e=e.split("%b`");if(e.length<2){return}e[0]=this.restore(e[0]);var f=a[e[0]]||{};a[e[0]]=th.mixin(f,this.parsedeclarations(e[1]))},this);return a},REbraces:/{[^{}]*}/,REfull:/\[[^\[\]]*\]|{[^{}]*}|\([^()]*\)|function(\s+\w+)?(\s*%b`\d+`b%){2}/,REatcomment:/\/\*@((?:[^\*]|\*[^\/])*)\*\//g,REcomment_string:/(?:\/\*(?:[^\*]|\*[^\/])*\*\/)|(\\.|"(?:[^\\\"]|\\.|\\\n)*"|'(?:[^\\\']|\\.|\\\n)*')/g,REmunged:/%\w`(\d+)`\w%/,uid:0,munged:{},munge:function(f,d){var a=this;f=f.replace(this.REatcomment,"$1").replace(this.REcomment_string,function(j,h){if(!h){return""}var i="%s`"+(++a.uid)+"`s%";a.munged[a.uid]=h.replace(/^\\/,"");return i});var e=d?this.REfull:this.REbraces;while(match=e.exec(f)){replacement="%b`"+(++this.uid)+"`b%";this.munged[this.uid]=match[0];f=f.replace(e,replacement)}return f},restore:function(a){if(a===undefined){return a}while(match=this.REmunged.exec(a)){a=a.replace(this.REmunged,this.munged[match[1]])}return th.trim(a)},parsedeclarations:function(d){var e=this.munged[d].replace(/(?:^\s*[{'"]\s*)|(?:\s*([^\\])[}'"]\s*$)/g,"$1");e=this.munge(e);var a={};th.forEach(e.split(";"),function(f){f=f.split(":");if(f.length<2){return}a[this.restore(f[0])]=this.restore(f[1])},this);return a}}});if(typeof th=="undefined"){th={}}th.EventHelpers=new Trait({methods:{wrapEvent:function(h,d){var a=h.clientX-th.cumulativeOffset(this.canvas).left;var i=h.clientY-th.cumulativeOffset(this.canvas).top;var f=d.getComponentForPosition(a,i,true);h.thComponent=f;this.addComponentXY(h,d,f)},addComponentXY:function(i,f,d){if(!d.bounds){console.log("No dest bounds - "+d.type);console.log(d.bounds);console.log(d);return}var a=i.clientX-th.cumulativeOffset(this.canvas).left;var l=i.clientY-th.cumulativeOffset(this.canvas).top;var h={x:a,y:l};var j=d;while(j){h.x-=j.bounds.x;h.y-=j.bounds.y;j=j.parent;if(j==f){i.componentX=h.x;i.componentY=h.y;return}}}}});th.StringHelpers=new Trait({methods:{isPercentage:function(a){return a.indexOf&&a.indexOf("%")!=-1}}});th.ComponentHelpers=new Trait({methods:{d:function(){var a=this.getInsets();return{b:(this.bounds)?{x:this.bounds.x,y:this.bounds.y,w:this.bounds.width,h:this.bounds.height,iw:this.bounds.width-a.left-a.right,ih:this.bounds.height-a.top-a.bottom}:{},i:{l:a.left,r:a.right,t:a.top,b:a.bottom,w:a.left+a.right,h:a.top+a.bottom}}},shouldPaint:function(){return(this.shouldLayout()&&this.cssValue("visibility")!="hidden")},shouldLayout:function(){return(this.cssValue("display")!="none")},emptyInsets:function(){return{left:0,right:0,bottom:0,top:0}},resolveCss:function(){var d=th.global_resources;if(!d.resolvedCssCache){d.resolvedCssCache={}}var n;var h=th.getHierarchyString(this);if(d.resolvedCssCache[h]){n=d.resolvedCssCache[h]}else{n={};var f;var m=["userAgentCss","userCss","authorCss"];for(var e=0;e<m.length;e++){var l=m[e];th.forEach(d[l],function(v){for(var q in v){var A=q.split(",");for(var B=0;B<A.length;B++){var t=th.trim(A[B]);var p=this.getSpecificity(t);var y=t.split(":");var z=y[0];y=(y.length>1)?y.slice(1):["(default)"];if(this.matchesSelector(z)){var x=v[q];for(f in x){for(var u=0;u<y.length;u++){var w=y[u];if(n[w]===undefined){n[w]={}}var o={value:x[f],selector:t,specificity:p};if(n[w][f]){o=this.getSpecificityWinner(o,n[w][f])}n[w][f]=o}}}}}},this)}d.resolvedCssCache[h]=n}this.styles={};for(var j in n){for(var a in n[j]){if(this.styles[j]===undefined){this.styles[j]={}}this.styles[j][a]=n[j][a].value}}this.refreshCss=false},matchesSelector:function(a){var h=a.toLowerCase();if(h=="*"){return true}if(h.indexOf(">")!=-1){var e=h.split(">");if(e.length!=2){console.log("unsupported child selector syntax; must be SEL1 > SEL2, was '"+a+"'");return false}if(this.matchesSelector(th.trim(e[1]))){if(!this.parent){return false}return(this.parent.matchesSelector(th.trim(e[0])))}return false}if(h.indexOf(" ")!=-1){var e=h.split(" ");if(e.length!=2){console.log("unsupported ancestor selector syntax; must be SEL1 SEL2, was '"+a+"'");return false}if(this.matchesSelector(th.trim(e[1]))){var d=this.parent;while(d){if(d.matchesSelector(th.trim(e[0]))){return true}d=d.parent}return false}}if(h.indexOf(".")==0){if(!this.className){return false}if(this.className.toLowerCase()==h.substring(1)){return true}}if(h.indexOf("#")==0){if(!this.id){return false}return("#"+this.id)==h}var f=this.type.toLowerCase();if(f==h){return true}if(this.id&&(h==(f+"#"+this.id))){return true}if(this.className&&(h==(f+"."+this.className.toLowerCase()))){return true}return false},getSpecificity:function(a,h){var e={a:0,b:0,c:0,d:0};if(h){e.a=1}var f=th.getSpaceDelimitedItems(a);for(var d=0;d<f.length;d++){var l=f[d];if(l=="*"||l=="+"||l==">"){continue}if(l.indexOf("#")==0){e.b+=1;continue}e.c+=l.split(".").length-1;var j=l.split(":");if(j.length==2){if(j[1]=="first-line"||j[1]=="first-letter"||j[1]=="before"||j[1]=="after"){e.d+=1}else{e.c+=1}}}return e},getSpecificityWinner:function(f,e){var d=f.specificity;var a=e.specificity;if(d.a>a.a){return f}if(a.a>d.a){return e}if(d.b>a.b){return f}if(a.b>d.b){return e}if(d.c>a.c){return f}if(a.c>d.c){return e}if(d.d>a.d){return f}if(a.d>d.d){return e}return f},paintBackground:function(e,a,j,d,i){if(a===undefined){a=0}if(j===undefined){j=0}if(d===undefined){d=this.bounds.width}if(i===undefined){i=this.bounds.height}if(this.cssValue("background-color")){e.fillStyle=this.cssValue("background-color");e.fillRect(a,j,d,i)}if(this.cssValue("background-image")){var f=this.cssValue("background-image");f=this.processImage(f,d,i);if(f){this.paintImage(e,f,this.cssValue("background-repeat"),this.cssValue("background-position"),a,j,d,i)}}},processImage:function(D,q,y){if(D.indexOf&&D.indexOf("-webkit-gradient")==0){var z=D.substring(D.indexOf("(")+1,D.length-1);var m=th.getCommaDelimitedItems(z);for(var x=0;x<m.length;x++){m[x]=th.trim(m[x])}if(m[0]!="linear"){console.log('Unsupported gradient: "'+D+'"; only linear gradients supported');return undefined}var l=m[1].split(" ");var j=m[2].split(" ");var u=[];var s=[];u[0]=(l[0]=="top"||l[0]=="bottom")?l[1]:l[0];u[1]=(l[0]=="top"||l[0]=="bottom")?l[0]:l[1];s[0]=(j[0]=="top"||j[0]=="bottom")?j[1]:j[0];s[1]=(j[0]=="top"||j[0]=="bottom")?j[0]:j[1];var p=[u,s];for(var C=0;C<p.length;C++){var d=p[C];for(var B=0;B<d.length;B++){if(d[B]=="top"){d[B]="0%"}if(d[B]=="bottom"){d[B]="100%"}if(d[B]=="left"){d[B]="0%"}if(d[B]=="right"){d[B]="100%"}if(th.isPercentage(d[B])){var o=parseInt(d[B])/100;d[B]=o*((B==0)?q:y)}}}var f=document.createElement("canvas");f.setAttribute("width",q);f.setAttribute("height",y);var v=f.getContext("2d");var e=v.createLinearGradient(u[0],u[1],s[0],s[1]);for(var A=3;A<m.length;A++){var t=m[A].split("(");if(t[1].indexOf(",")!=-1){var n=t[1].split(",");e.addColorStop(n[0],n[1])}else{t[1]=t[1].substring(0,t[1].length-1);e.addColorStop((t[0].toLowerCase()=="from"?0:1),t[1])}}v.fillStyle=e;v.fillRect(0,0,q,y);return f}else{return D}},paintImage:function(v,E,j,D,l,f,n,B){if(!j){j="repeat"}if(!D){D="0% 0%"}if(!l){l=0}if(!f){f=0}if(!n){n=this.bounds.width}if(!B){B=this.bounds.height}v.save();try{if((l!=0)||(f!=0)){v.translate(l,f)}var e=D.toLowerCase().split(" ");if(e.length==1){e.push("50%")}if(e.length!=2){console.log('Unsupported position syntax; only "X" or "X Y" supported, you passed in " + position + "');return}var d=[];d[0]=(e[0]=="top"||e[0]=="bottom")?e[1]:e[0];d[1]=(e[0]=="top"||e[0]=="bottom")?e[0]:e[1];th.forEach(d,function(i,h){if(i=="top"){d[h]="0%"}if(i=="right"){d[h]="100%"}if(i=="bottom"){d[h]="100%"}if(i=="left"){d[h]="0%"}if(i=="center"){d[h]="50%"}});var m=[0,0];for(var A=0;A<d.length;A++){var o=th.isPercentage(d[A]);var u=this.convertPositionToPixel(d[A],(A==0)?n:B);if(o){m[A]=this.convertPositionToPixel(d[A],(A==0)?E.width:E.height)}d[A]=u}var t=d[0]-m[0];var s=d[1]-m[1];if(!this.shouldRepeat(j)){v.drawImage(E,d[0]-m[0],d[1]-m[1])}else{var a=(this.shouldRepeatX(j))?parseInt(n/E.width)+1:1;var z=(this.shouldRepeatY(j))?parseInt(B/E.height)+1:1;if(this.shouldRepeatX(j)){while(t>0){t-=E.width}}if(this.shouldRepeatY(j)){while(s>0){s-=E.height}}var q=t;for(var p=0;p<z;p++){t=q;for(var C=0;C<a;C++){v.drawImage(E,t,s);t+=E.width}s+=E.height}}}finally{v.restore()}},shouldRepeatX:function(a){return(a=="repeat"||a=="repeat-x")},shouldRepeatY:function(a){return(a=="repeat"||a=="repeat-y")},shouldRepeat:function(a){return(a!="no-repeat")},convertPositionToPixel:function(e,d){if(th.isPercentage(e)){var a=e.substring(0,e.length-1)/100;return d*a}else{if(th.isCssPixel(e)){return e.substring(0,e.length-2)}}},calculateInsets:function(j,a,d){if(!this["insetCache"]){this.insetCache={}}var i=j+a;if(this.insetCache[i]){return this.insetCache[i]}if(!d){d={top:0,bottom:0,left:0,right:0}}var e=(this.component)?this.component:this;for(var f in d){var h=th.safeget(e.cssValue(j+f+a),0);if(h){h=th.convertLengthToPixels(h,e)}d[f]+=h}this.insetCache[i]=d;return d},getCurrentPseudoClass:function(){if(this.pseudoClass){return this.pseudoClass}return"(default)"},cssValue:function(d,a){if(a===undefined){a=this.getCurrentPseudoClass()}if(this.localStyles[a]===undefined){this.localStyles[a]={}}if(this.localStyles[a][d]!==undefined){return this.localStyles[a][d]}if(typeof this.styles=="undefined"||this.refreshCss){this.resolveCss()}if(this.styles[a]===undefined){this.styles[a]={}}if(this.styles[a][d]){return this.styles[a][d]}if(a!="(default)"){return this.cssValue(d,"(default)")}if(d=="border-top-color"||d=="border-left-color"||d=="border-right-color"||d=="border-bottom-color"){return this.cssValue("color")}if(d=="border"||d=="border-top"||d=="border-left"||d=="border-right"||d=="border-bottom"){throw"Unsupported: request the individual border properties, please"}if(d=="margin"){throw"Unsupported: request the individual margin-top, margin-bottom, margin-right, and margin-left properties, please"}if(d=="padding"){throw"Unsupported: request the individual padding-top, padding-bottom, padding-right, and padding-left properties, please"}if(["color","letter-spacing","line-height","text-align","text-indent","text-transform","visibility","white-space","word-spacing","font"].indexOf(d)!=-1){if(this.parent){return this.parent.cssValue(d)}}if(d.indexOf("list-style-")!=-1){if(this.parent){return this.parent.cssValue(d)}}return},addCss:function(d,f,a){if(th.isString(d)){var h=d;if(h.indexOf("border")!=-1||h.indexOf("padding")!=-1||h.indexOf("margin")!=-1){this.insetsCache={};this.border.insetsCache={}}if(a===undefined){a="(default)"}if(this.localStyles[a]===undefined){this.localStyles[a]={}}this.localStyles[a][h]=f}else{for(var e in d){this.addCss(e,d[e],a)}}},getSize:function(){var a=this.bounds;return{width:a.width,height:a.height}},setBounds:function(a,f,d,e){this.bounds={x:a,y:f,width:d,height:e}},getPreferredSize:function(){if(this.getPreferredHeight&&this.getPreferredWidth){var a=this.getPreferredHeight();var e=this.getPreferredWidth();return{height:a,width:e}}var d=this.getInsets();return{height:d.top+d.bottom,width:d.left+d.right}},getMinimumSize:function(){if(this.getMinimumHeight&&this.getMinimumWidth){var a=this.getMinimumHeight();var d=this.getMinimumWidth();return{height:a,width:d}}return this.getPreferredSize()},getMaximumSize:function(){if(this.getMaximumHeight&&this.getMaximumWidth){var a=this.getMaximumHeight();var d=this.getMaximumWidth();return{height:a,width:d}}return this.getPreferredSize()},getScene:function(){if(this.scene){return this.scene}if(!this.parent){return}var a=this.parent;while(!a.scene&&a.parent){a=a.parent}return a.scene}}});th.ContainerHelpers=new Trait({methods:{getChildById:function(d){for(var a=0;a<this.children.length;a++){if(this.children[a].id==d){return this.children[a]}}},getComponentForPosition:function(a,f,e){for(var d=0;d<this.children.length;d++){if(!this.children[d].bounds){continue}if(this.children[d].bounds.x<=a&&this.children[d].bounds.y<=f&&(this.children[d].bounds.x+this.children[d].bounds.width)>=a&&(this.children[d].bounds.y+this.children[d].bounds.height)>=f){if(!e){return this.children[d]}if(!this.children[d].shouldPaint()){continue}return(this.children[d].getComponentForPosition)?this.children[d].getComponentForPosition(a-this.children[d].bounds.x,f-this.children[d].bounds.y,e):this.children[d]}}return this},removeAll:function(){this.remove(this.children)},getMinimumSize:function(){return(this.layoutManager)?this.layoutManager.getMinimumSize(this):this._super()},getPreferredSize:function(){return(this.layoutManager)?this.layoutManager.getPreferredSize(this):this._super()},getMaximumSize:function(){return(this.layoutManager)?this.layoutManager.getMaximumSize(this):this._super()}}});if(typeof th=="undefined"){th={}}th.VERTICAL="v";th.HORIZONTAL="h";th.Resources=Class.define({members:{init:function(){this.loading=false;this.userAgentCss=[];this.authorCss=[];this.userCss=[];this.blockUntilImagesLoaded=true;this.images={};this.sheetCount=0;this.currentSheet=0;this.imageCount=0;this.currentImage=0;this.loaded=false;this.cssLoaded=false;this.imagesLoaded=false;this.callbacks=[]},load:function(d,a){if(this.loaded){return}this.baseUrl=d;this.stringStyles=a;this.loading=true;this.parseCSS()},processImage:function(){this.currentImage++;if(this.imageCount==this.currentImage){this.imagesLoaded=true;this.onLoaded()}},onLoaded:function(){if(this.cssLoaded&&((this.blockUntilImagesLoaded&&this.imagesLoaded)||!this.blockUntilImagesLoaded)){this.loaded=true;this.loading=false;if(this.callbacks){th.forEach(this.callbacks,function(a){if(a.context){a.callback.apply(a.context)}else{a.callback()}})}}},registerOnLoadCallback:function(d,a){this.callbacks.push({callback:d,context:a})},parseCSS:function(){var e=[];var j=false;if(typeof this.baseUrl!=="undefined"){e.push({url:this.baseUrl+"css/default.css",array:this.userAgentCss,index:0})}else{if(th.DEFAULT_CSS){this.processCSS(th.DEFAULT_CSS,this.userAgentCss,0);j=true}}var h,d=document.getElementsByTagName("link");var a=0;for(var f=0;f<d.length;f++){h=d[f];if(h.rel.toLowerCase().indexOf("thstylesheet")>=0&&h.href){e.push({url:h.href,array:this.authorCss,index:a++})}}if(this.stringStyles){this.processCSS(this.stringStyles,this.authorCss,a++)}if(e.length==0){this.cssLoaded=true;return this.onLoaded()}this.sheetCount=e.length;if(j){this.sheetCount++}if(this.stringStyles){this.sheetCount++}th.forEach(e,function(i){th.xhrGet({url:i.url,load:function(l){this.processCSS(l,i.array,i.index)},context:this})},this)},processCSS:function(a,j,h){j[h]=new th.CssParser().parse(a);for(var m in j[h]){var l=[];for(var o in j[h][m]){l.push(o)}for(var f=0;f<l.length;f++){o=l[f];var n=j[h][m][o];if(n.indexOf("url(")==0&&n.indexOf(")")==n.length-1){var d=n.substring(4,n.length-1);if(d.indexOf("'")==0||d.indexOf('"')==0){d=n.substring(1,n.length-1)}this.imageCount++;var e=new Image();if(this.blockUntilImagesLoaded){this.imagesLoaded=false;var p=this;e.onload=function(){p.processImage()};e.onerror=function(){p.processImage()}}e.src=d;this.images[n]=e;j[h][m][o]=e}if(o=="margin"||o=="padding"){this.expandMarginOrPadding(o,n,j[h][m],l)}if(o=="border"){this.expandProperty("border-top",n,j[h][m],l);this.expandProperty("border-right",n,j[h][m],l);this.expandProperty("border-bottom",n,j[h][m],l);this.expandProperty("border-left",n,j[h][m],l)}if(o=="border-top"||o=="border-left"||o=="border-right"||o=="border-bottom"){this.expandBorder(o,n,j[h][m],l)}}}if(++this.currentSheet==this.sheetCount){this.cssLoaded=true;this.onLoaded()}},expandBorder:function(j,h,e,f){var a=th.getSpaceDelimitedItems(h);for(var d=0;d<a.length;d++){if(th.isCssLength(a[d])){this.expandProperty(j+"-width",a[d],e,f)}else{if(th.isCssBorderStyle(a[d])){this.expandProperty(j+"-style",a[d],e,f)}else{this.expandProperty(j+"-color",a[d],e,f)}}}delete e[j]},expandProperty:function(a,f,d,e){d[a]=f;e.push(a)},expandMarginOrPadding:function(h,f,d,e){var a=f.split(" ");if(a.length==3){a=[a[0],a[1],a[2],a[1]]}if(a.length==2){a=[a[0],a[1],a[0],a[1]]}if(a.length==1){a=[a[0],a[0],a[0],a[0]]}if(a.length>=4){this.expandProperty(h+"-top",a[0],d,e);this.expandProperty(h+"-right",a[1],d,e);this.expandProperty(h+"-bottom",a[2],d,e);this.expandProperty(h+"-left",a[3],d,e);delete d[h]}}}});th.Bus=Class.define({members:{init:function(){this.events={}},bind:function(h,d,a,j){var f=this.events[h];if(!f){f=[];this.events[h]=f}d=th.isArray(d)?d:[d];for(var l=0;l<d.length;l++){for(var e=0;e<f.length;e++){if(f[e].selector==d[l]&&f[e].listenerFn==a){return}}f.push({selector:d[l],listenerFn:a,context:j})}},unbind:function(a){for(var f in this.events){var e=this.events[f];for(var d=0;d<e.length;d++){if(e[d].selector===a){this.events[f]=th.remove(e,e[d]);e=this.events[f];d--}}}},fire:function(a,h,d){var f=this.events[a];if(!f||f.length==0){return}for(var e=0;e<f.length;e++){if(f[e].selector.constructor==String){if(f[e].selector.charAt(0)=="#"){if(d.id==f[e].selector.substring(1)){this.dispatchEvent(a,h,d,f[e])}}else{if(f[e].selector==d.declaredClass){this.dispatchEvent(a,h,d,f[e])}}}else{if(f[e].selector==d){this.dispatchEvent(a,h,d,f[e])}}}},dispatchEvent:function(a,e,d,f){e.thComponent=d;if(f.context){f.listenerFn.apply(f.context,[e])}else{f.listenerFn(e)}}}});th.global_event_bus=new th.Bus();th.global_resources=new th.Resources();th.Scene=Class.define({uses:[th.EventHelpers],members:{bus:th.global_event_bus,init:function(a,h){if(th.isString(a)){a=document.getElementById("canvasOrId")}this.canvas=a;var f=h;var e="";if(h&&!th.isString(h)){f=h.baseUrl;e=h.stringStyles}this.smartRedraw=false;this.resources=th.global_resources;this.resourceCallbackRegistered=false;if(!this.resources.loaded&&!this.resources.loading){this.resources.load(f,e)}th.observe(window,"resize",function(){this.render()},this);this.root=new th.Panel({id:"root"});this.root.scene=this;var d=document.createElement("canvas");this.scratchContext=d.getContext("2d");th.fixCanvas(this.scratchContext);this.parseTags();th.observe(window,"mousedown",function(i){this.wrapEvent(i,this.root);this.mouseDownComponent=i.thComponent;th.global_event_bus.fire("mousedown",i,i.thComponent)},this);th.observe(window,"dblclick",function(i){this.wrapEvent(i,this.root);th.global_event_bus.fire("dblclick",i,i.thComponent)},this);th.observe(window,"click",function(i){this.wrapEvent(i,this.root);th.global_event_bus.fire("click",i,i.thComponent)},this);th.observe(window,"mousemove",function(i){this.wrapEvent(i,this.root);th.global_event_bus.fire("mousemove",i,i.thComponent);if(this.mouseDownComponent){this.addComponentXY(i,this.root,this.mouseDownComponent);th.global_event_bus.fire("mousedrag",i,this.mouseDownComponent)}},this);th.observe(window,"mouseup",function(i){if(!this.mouseDownComponent){return}this.addComponentXY(i,this.root,this.mouseDownComponent);th.global_event_bus.fire("mouseup",i,this.mouseDownComponent);delete this.mouseDownComponent},this)},render:function(a){if(!this.resources.loaded){if(!this.resourceCallbackRegistered){this.resources.registerOnLoadCallback(this.render,this);if(a){this.resources.registerOnLoadCallback(function(){a(this)},this)}this.resourceCallbackRegistered=true}return}this.layout();this.paint();if(a){a(this)}},blockUntilRender:function(){if(!this.resources.loaded){}},parseTags:function(){this.parseCanvasAttributes("grid");var a=this.canvas.childNodes;this.attachChildElementsToParent(a,this.root)},parseCanvasAttributes:function(){th.forEach(arguments,function(a){if(this.canvas.hasAttribute(a)){this.root[a]=this.canvas.getAttribute(a)}},this)},attachChildElementsToParent:function(a,d){th.forEach(a,function(f){if(f.nodeType==Node.ELEMENT_NODE){var e=this.createComponentFromElement(f,d);if(e){d.add(e);this.attachChildElementsToParent(f.childNodes,e)}else{console.log("Couldn't create component from element \""+f.tagName+'"')}}},this)},createComponentFromElement:function(a,f){var l={};for(var n in th){var i=n.toLowerCase();if(l[i]){console.log('componentMap collision with key "'+i+'"')}l[i]=n}var d=a.tagName.toLowerCase();n=l[d];if(!n){return}var e=th[n];if(!e){return}var j=a.attributes;var h={};th.forEach(j,function(p){var o=p.name;var q=p.value;if(o=="cell"){o="constraints"}h[o]=q});var m=new e(h);if(!m.type){return}if(m.type.toLowerCase()!=d){return}return m},layout:function(){if(this.root){this.root.bounds={x:0,y:0,width:this.canvas.width,height:this.canvas.height};this.root.layoutTree()}},paint:function(d){if(!this.resources.loaded){if(!this.resourceCallbackRegistered){this.resources.registerOnLoadCallback(this.render,this);this.resourceCallbackRegistered=true}return}if(!d){d=this.root}if(d){if(d===this.root){d.resolveCss()}if(!d.opaque&&d.parent){return this.paint(d.parent)}var a=this.canvas.getContext("2d");th.fixCanvas(a);a.save();var e=d.parent;var f=d;while(e){a.translate(f.bounds.x,f.bounds.y);f=e;e=e.parent}if(!this.smartRedraw){a.clearRect(0,0,d.bounds.width,d.bounds.height)}a.beginPath();a.rect(0,0,d.bounds.width,d.bounds.height);a.closePath();a.clip();d.paint(a);a.restore()}}}});th.Rectangle=function(){if(arguments.length==1){this.x=arguments[0].x;this.y=arguments[0].y;this.w=arguments[0].w;this.h=arguments[0].h}else{if(arguments.length==4){this.x=arguments[0];this.y=arguments[1];this.w=arguments[2];this.h=arguments[3]}else{this.x=this.y=this.w=this.h=0}}};th.Rectangle.prototype.TOP=0;th.Rectangle.prototype.RIGHT=1;th.Rectangle.prototype.BOTTOM=2;th.Rectangle.prototype.LEFT=3;th.Rectangle.prototype.TOP_LEFT=0;th.Rectangle.prototype.TOP_RIGHT=1;th.Rectangle.prototype.BOTTOM_RIGHT=2;th.Rectangle.prototype.BOTTOM_LEFT=3;th.Rectangle.prototype.round=function(){this.x=Math.round(this.x);this.y=Math.round(this.y);this.w=Math.round(this.w);this.h=Math.round(this.h)};th.Rectangle.prototype.inset=function(){if(arguments.length==1){var i=arguments[0];if(typeof i=="number"){this.x+=i;this.y+=i;this.w-=2*i;this.h-=2*i}else{if((i instanceof Array)&&i.length==4){this.x+=i[this.LEFT];this.y+=i[this.TOP];this.w-=i[this.RIGHT]+i[this.LEFT];this.h-=i[this.TOP]+i[this.BOTTOM]}}}else{if(arguments.length==4){var h=arguments[0];var e=arguments[1];var a=arguments[2];var f=arguments[3];this.x+=f;this.y+=h;this.w-=f+e;this.h-=h+a}}};th.Rectangle.prototype.corner=function(a){switch(a){case this.TOP_LEFT:return{x:this.x,y:this.y};case this.TOP_RIGHT:return{x:this.x+this.w,y:this.y};case this.BOTTOM_RIGHT:return{x:this.x+this.w,y:this.y+this.h};case this.BOTTOM_LEFT:return{x:this.x,y:this.y+this.h}}};th.Rectangle.prototype.isEmpty=function(){return(this.w<=0||this.h<=0)};th.Size2D=function(){if(arguments.length==1){this.w=arguments[0].w;this.h=arguments[0].h}else{if(arguments.length==2){this.w=arguments[0];this.h=arguments[1]}else{this.w=this.h=0}}};th.Size2D.prototype.isZero=function(){return(this.w==0)&&(this.h==0)};th.SimpleBorder=Class.define({type:"Border",uses:[th.ComponentHelpers],members:{init:function(a){this.SIDES=["top","right","bottom","left"];this.component=a},getBorderWidth:function(a){var d=this.component.cssValue("border-"+a+"-width");if(d===undefined){return 0}return th.convertLengthToPixels(d,this.component)},getInsets:function(){return this.calculateInsets()},paint:function(n){for(var e=0;e<this.SIDES.length;e++){var o=this.SIDES[e];var a=this.getBorderWidth(o);if(a>0){var d=this.component.cssValue("border-"+o+"-color");var l,j,f,m;switch(o){case"top":l=0;j=0;f=a;m=this.component.bounds.width;break;case"right":l=this.component.bounds.width-a;j=0;f=this.component.bounds.height;m=a;break;case"bottom":l=0;j=this.component.bounds.height-a;f=a;m=this.component.bounds.width;break;case"left":l=0;j=0;f=this.component.bounds.height;m=a;break}this.paintBorder(n,d,l,j,m,f)}}},paintBorder:function(e,f,a,j,d,i){e.fillStyle=f;e.fillRect(a,j,d,i)}}});th.Border=Class.define({type:"Border",uses:[th.ComponentHelpers],members:{SIDES:["top","right","bottom","left"],CORNERS:["top-left","top-right","bottom-right","bottom-left"],TOP:0,TOP_LEFT:0,RIGHT:1,TOP_RIGHT:1,BOTTOM:2,BOTTOM_RIGHT:2,LEFT:3,BOTTOM_LEFT:3,BIT_TOP:1,BIT_RIGHT:2,BIT_BOTTOM:4,BIT_LEFT:8,init:function(a){this.component=a;this.outerRect=new th.Rectangle();this.innerRect=new th.Rectangle();this.borderStyles=[];this.borderWidths=[];this.borderRadii=[];this.borderColors=[];this.skipSides=0;this.oneUnitBorder=false;this.noBorderRadius=false;this.cornerDimensions={};for(var d=0;d<4;d++){this.borderStyles[d]="none";this.borderWidths[d]=0;this.borderColors[d]="rgba(0, 0, 0, 0)";this.borderRadii[d]=new th.Size2D();this.cornerDimensions[d]=new th.Size2D()}},getInsets:function(){return this.calculateInsets("border-","-width")},recalculateBorderData:function(){var n=this.component.d();var m=this.component.getScratchContext();var e="",h,f,a;for(var l=0;l<4;l++){var j=this.SIDES[l];h=th.convertBorderLengthToPixels(this.component.cssValue("border-"+j+"-width"));e=this.component.cssValue("border-"+j+"-color");if(e!==undefined){m.fillStyle=e;f=m.fillStyle;a=this.component.cssValue("border-"+j+"-style")}this.borderWidths[l]=(h===undefined)?0:h;this.borderColors[l]=(f===undefined)?"rgb(0, 0, 0)":f;this.borderStyles[l]=(a===undefined)?"none":a}this.outerRect=new th.Rectangle(0,0,n.b.w,n.b.h);this.innerRect=new th.Rectangle(this.outerRect);this.innerRect.inset(this.borderWidths[0],this.borderWidths[1],this.borderWidths[2],this.borderWidths[3]);this.cornerDimensions[0].w=this.borderWidths[3];this.cornerDimensions[0].h=this.borderWidths[0];this.cornerDimensions[1].w=this.borderWidths[1];this.cornerDimensions[1].h=this.borderWidths[0];this.cornerDimensions[2].w=this.borderWidths[1];this.cornerDimensions[2].h=this.borderWidths[2];this.cornerDimensions[3].w=this.borderWidths[3];this.cornerDimensions[3].h=this.borderWidths[2];this.oneUnitBorder=this.checkFourFloatsEqual(this.borderWidths,1);this.noBorderRadius=this.allCornersZeroSize(this.borderRadii);e=this.component.cssValue("background-color");if(e!==undefined){m.fillStyle=e}this.backgroundColor=m.fillStyle},next:function(d){var a=(d+1)%4;if(a<0){return a+4}return a},prev:function(d){var a=(d-1)%4;if(a<0){return a+4}return a},allCornersZeroSize:function(a){return(a[0].isZero()&&a[1].isZero()&&a[2].isZero()&&a[3].isZero())},checkFourFloatsEqual:function(a,d){return(a[0]==d&&a[1]==d&&a[2]==d&&a[3]==d)},areBorderSideFinalStylesSame:function(d){if(d==0){throw"th.Border:areBorderSideFinalStyleSame - Invalid side bit-field '0'"}firstStyle=0;for(var a=0;a<4;a++){if(firstStyle==a){if(((1<<a)&d)==0){firstStyle++}continue}if(((1<<a)&d)==0){continue}if(this.borderStyles[firstStyle]!=this.borderStyles[a]||this.borderColors[firstStyle]!=this.borderColors[a]){return false}}switch(this.borderStyles[firstStyle]){case"groove":case"ridge":case"inset":case"outset":return((d&(this.BIT_TOP|this.BIT_LEFT))==0||(d&(this.BIT_BOTTOM|this.BIT_RIGHT))==0)}return true},isSolidCornerStyle:function(d,a){switch(d){case"dotted":case"dashed":case"solid":return true;case"inset":case"outset":return a==this.TOP_LEFT||a==this.BOTTOM_RIGHT;case"groove":case"ridge":return this.oneUnitBorder&&(a==this.TOP_LEFT||a==this.BOTTOM_RIGHT);case"double":return this.oneUnitBorder;default:return false}},borderColorStyleForSolidCorner:function(d,a){switch(d){case"dotted":case"dashed":case"solid":case"double":return"solid";case"inset":case"groove":if(a==this.TOP_LEFT){return"dark"}else{if(a==this.BOTTOM_RIGHT){return"light"}}break;case"outset":case"ridge":if(a==this.TOP_LEFT){return"light"}else{if(a==this.BOTTOM_RIGHT){return"dark"}}break}return"none"},doCornerSubPath:function(a,d){var e={x:0,y:0};if(d==this.TOP_RIGHT||d==this.BOTTOM_RIGHT){e.x=this.outerRect.w-this.cornerDimensions[d].w}if(d==this.BOTTOM_RIGHT||d==this.BOTTOM_LEFT){e.y=this.outerRect.h-this.cornerDimensions[d].h}a.rect(this.outerRect.x+e.x,this.outerRect.y+e.y,this.cornerDimensions[d].w,this.cornerDimensions[d].h)},doSideClipWithoutCornersSubPath:function(d,a){var h={x:0,y:0};var f=this.next(a);if(a==this.TOP){h.x=this.cornerDimensions[this.TOP_LEFT].w}else{if(a==this.RIGHT){h.x=this.outerRect.w-this.borderWidths[this.RIGHT];h.y=this.cornerDimensions[this.TOP_RIGHT].h}else{if(a==this.BOTTOM){h.x=this.cornerDimensions[this.BOTTOM_LEFT].w;h.y=this.outerRect.h-this.borderWidths[this.BOTTOM]}else{if(a==this.LEFT){h.y=this.cornerDimensions[this.TOP_LEFT].h}}}}var i=new th.Size2D();i.w=this.cornerDimensions[a].w+this.cornerDimensions[f].w;i.h=this.cornerDimensions[a].h+this.cornerDimensions[f].h;var e=new th.Rectangle(this.outerRect.x+h.x,this.outerRect.y+h.y,this.outerRect.w-i.w,this.outerRect.h-i.h);if(a==this.TOP||a==this.BOTTOM){e.h=this.borderWidths[a]}else{e.w=this.borderWidths[a]}d.rect(e.x,e.y,e.w,e.h)},maybeMoveToMidPoint:function(e,a,f){var d={x:a.x-e.x,y:a.y-e.y};if(d.x!=0&&d.y!=0){k=Math.min((f.x-e.x)/d.x,(f.y-a.y)/d.y);a.x=e.x+d.x*k;a.y=e.y+px.y*k}},doSideClipSubPath:function(o,f){var a=[{x:0,y:0},{x:0,y:0}];var d=[{x:0,y:0},{x:0,y:0}];var e=this.prev(f);var l=this.next(f);var p=this.borderStyles[f]=="dashed"||this.borderStyles[f]=="dotted";var n=this.borderStyles[e]=="dashed"||this.borderStyles[e]=="dotted";var i=this.borderStyles[l]=="dashed"||this.borderStyles[l]=="dotted";var h=0;var m=0;if(!this.borderRadii[f].isZero()){h=1}else{if(n&&p){h=2}}if(!this.borderRadii[l].isZero()){m=1}else{if(n&&p){m=2}}var j={x:0,y:0};j.x=this.innerRect.x+this.innerRect.w/2;j.y=this.innerRect.y+this.innerRect.h/2;a[0]=this.outerRect.corner(f);a[1]=this.innerRect.corner(f);d[0]=this.outerRect.corner(l);d[1]=this.innerRect.corner(l);if(h==1){this.maybeMoveToMidPoint(a[0],a[1],j)}else{if(h==2){if(side=="top"||side=="bottom"){a[1]={x:this.outerRect.corner(f).x,y:this.innerRect.corner(f).y}}else{a[1]={x:this.innerRect.corner(f).x,y:this.outerRect.corner(f).y}}}}if(m==1){this.maybeMoveToMidPoint(d[0],d[1],j)}else{if(m==2){if(side=="top"||side=="bottom"){d[0]={x:this.innerRect.corner(l).x,y:this.outerRect.corner(l).y}}else{d[0]={x:this.outerRect.corner(l).x,y:this.innerRect.corner(l).y}}}}o.moveTo(a[0].x,a[0].y);o.lineTo(d[0].x,d[0].y);o.lineTo(d[1].x,d[1].y);o.lineTo(a[1].x,a[1].y);o.closePath()},fillSolidBorder:function(m,o,h,d,l,j,e){m.fillStyle=e;if(!this.allCornersZeroSize(d)){var n=this.computeInnerRadii(d,l);m.beginPath();this.traceRoundRect(m,o,d,true);this.traceRoundRect(m,h,n,false);m.fill();return}if(j==15&&this.checkFourFloatsEqual(l,l[0])){var a=new th.Rectangle(o);a.inset(l[0]/2);m.strokeStyle=e;m.lineWidth=l[0];m.beginPath();m.rect(a.x,a.y,a.w,a.h);m.stroke();return}var a=[{x:0,y:0,w:0,h:0},{x:0,y:0,w:0,h:0},{x:0,y:0,w:0,h:0},{x:0,y:0,w:0,h:0}];if(j&this.BIT_TOP){a[this.TOP].x=o.x;a[this.TOP].y=o.y;a[this.TOP].w=o.w;a[this.TOP].h=l[this.TOP]}if(j&this.BIT_BOTTOM){a[this.BOTTOM].x=o.x;a[this.BOTTOM].y=o.y+o.h;a[this.BOTTOM].y-=l[this.BOTTOM];a[this.BOTTOM].w=o.w;a[this.BOTTOM].h=l[this.BOTTOM]}if(j&this.BIT_LEFT){a[this.LEFT].x=o.x;a[this.LEFT].y=o.y;a[this.LEFT].w=l[this.LEFT];a[this.LEFT].h=o.h}if(j&this.BIT_RIGHT){a[this.RIGHT].x=o.x+o.w;a[this.RIGHT].y=o.y;a[this.RIGHT].x-=l[this.RIGHT];a[this.RIGHT].w=l[this.RIGHT];a[this.RIGHT].h=o.h}if((j&(this.BIT_TOP|this.BIT_LEFT))==(this.BIT_TOP|this.BIT_LEFT)){a[this.LEFT].y+=l[this.TOP];a[this.LEFT].h-=l[this.TOP]}if((j&(this.BIT_TOP|this.BIT_RIGHT))==(this.BIT_TOP|this.BIT_RIGHT)){a[this.TOP].w-=l[this.RIGHT]}if((j&(this.BIT_BOTTOM|this.BIT_RIGHT))==(this.BIT_BOTTOM|this.BIT_RIGHT)){a[this.RIGHT].h-=l[this.BOTTOM]}if((j&(this.BIT_BOTTOM|this.BIT_LEFT))==(this.BIT_BOTTOM|this.BIT_LEFT)){a[this.BOTTOM].x+=l[this.LEFT];a[this.BOTTOM].w-=l[this.LEFT]}for(var f=0;f<4;f++){if(j&(1<<f)){m.beginPath();m.rect(a[f].x,a[f].y,a[f].w,a[f].h);m.fill()}}},getLuminosity:function(e,d,a){return e*299+d*587+a*114},getBrightness:function(h,f,d){var a=(h+f+d)/3;var e=this.getLuminosity(h,f,d)/1000;return(a*25+e*75)/100},getSpecial3DColors:function(d,p){var n=[];var i,h;var a=parseInt(p.substring(1,2),16);var o=parseInt(p.substring(3,2),16);var l=parseInt(p.substring(5,2),16);var e=parseInt(d.substring(1,2),16);var f=parseInt(d.substring(3,2),16);var m=parseInt(d.substring(5,2),16);var j=this.getBrightness(a,o,l);var q=this.getBrightness(e,f,m);if(q<51){i=30;h=50;if(j==0){a=o=l=96}}else{if(q>204){i=45;h=70;if(j==254){a=o=l=192}}else{i=30+(q/17);h=50+(q*20/255)}}r=a-(i*a/100);g=o-(i*o/100);b=l-(i*l/100);n[0]="rgb("+parseInt(r)+","+parseInt(g)+","+parseInt(b)+")";r=a+(h*(255-a)/100);g=o+(h*(255-o)/100);b=l+(h*(255-l)/100);n[1]="rgb("+parseInt(r)+","+parseInt(g)+","+parseInt(b)+")";return n},makeBorderColor:function(d,f,h){var a;var e=0;switch(h){case"none":return"rgba(0, 0, 0, 0)";case"light":e=1;case"dark":a=this.getSpecial3DColors(f,d);return a[e];case"solid":default:return d}},computeColorForLine:function(a,h,d,e,f){return this.makeBorderColor(e,f,h[a])},drawBorderSides:function(v,p){if(p==0){return}var a;var f;var h=[];var s=[];var n=0;var o=[];for(var m=0;m<4;m++){if(((1<<m)&p)==0){continue}a=this.borderStyles[m];f=this.borderColors[m];break}if(a=="none"||a=="hidden"){return}if(this.oneUnitBorder&&(a=="ridge"||a=="groove"||a=="double")){a="solid"}switch(a){case"solid":case"dashed":case"dotted":h[0]="solid";s[0]="solid";n=1;break;case"groove":h[0]="dark";h[1]="light";s[0]="light";s[1]="dark";n=2;break;case"ridge":h[0]="light";h[1]="dark";s[0]="dark";s[1]="light";n=2;break;case"double":h[0]="solid";h[1]="none";h[2]="solid";s[0]="solid";s[1]="none";s[2]="solid";n=3;break;case"inset":h[0]="dark";s[0]="light";n=1;break;case"outset":h[0]="light";s[0]="dark";n=1;break;default:throw"Unhandled style '"+a+"'";break}if(p&(this.BIT_RIGHT|this.BIT_BOTTOM)){o=s}else{o=h}var u=[[],[],[]];if(n==1){for(var m=0;m<4;m++){u[0][m]=this.borderWidths[m]}}else{if(n==2){for(var m=0;m<4;m++){var q=this.borderWidths[m];u[0][m]=Math.floor(q/2)+q%2;u[1][m]=Math.floor(q/2)}}else{if(n==3){for(var m=0;m<4;m++){var q=this.borderWidths[m];if(q==1){u[0][m]=1;u[1][m]=u[2][m]=0}else{var d=q%3;u[0][m]=u[2][m]=u[1][m]=Math.floor((q-d)/3);if(d==1){u[1][m]++}else{if(d==2){u[0][m]++;u[2][m]++}}}}}}}var l=new th.Rectangle(this.outerRect);var t=new th.Rectangle(this.outerRect);var j=this.copyRadii(this.borderRadii);for(var m=0;m<n;m++){t.inset(u[m]);if(o[m]!="none"){var e=this.computeColorForLine(m,o,n,f,this.backgroundColor);this.fillSolidBorder(v,l,t,j,u[m],p,e)}j=this.computeInnerRadii(j,u[m]);l.x=t.x;l.y=t.y;l.w=t.w;l.h=t.h}},paint:function(s){var m=this.component.d();this.recalculateBorderData();var h=this.areBorderSideFinalStylesSame(1|8);var q=this.areBorderSideFinalStylesSame(2|4);var d=this.areBorderSideFinalStylesSame(15);if(d&&(this.borderStyles[0]=="none"||this.borderStyles[0]=="hidden")){return}this.outerRect.round();this.innerRect.round();if(this.outerRect.isEmpty()){return}if(d){this.drawBorderSides(s,this.BIT_TOP|this.BIT_RIGHT|this.BIT_BOTTOM|this.BIT_LEFT)}else{for(var o=0;o<4;o++){var e=[o,this.prev(o)];if(!this.borderRadii[o].isZero()){continue}if(this.borderWidths[e[0]]==1&&this.borderWidths[e[1]]==1){if(o==this.TOP_LEFT||o==this.TOP_RIGHT){this.cornerDimensions[o].w=0}else{this.cornerDimensions[o].h=0}}}for(var o=0;o<4;o++){if(this.cornerDimensions[o].isZero()){continue}var e=[o,this.prev(o)];var i=(1<<e[0])|(1<<e[1]);var f=this.areBorderSideFinalStylesSame(i);if(f&&this.borderRadii[o].isZero()&&this.isSolidCornerStyle(this.borderStyles[e[0]],o)){s.beginPath();this.doCornerSubPath(s,o);s.fillStyle=this.makeBorderColor(this.borderColors[e[0]],this.backgroundColor,this.borderColorStyleForSolidCorner(this.borderStyles[e[0]],o));s.fill();continue}s.save();s.beginPath();this.doCornerSubPath(s,o);s.clip();if(f){this.drawBorderSides(s,i)}else{var n=this.component.getScratchContext();n.canvas.height=m.b.h;n.canvas.width=m.b.w;n.clearRect(0,0,m.b.w,m.b.h);n.globalCompositeOperation="lighter";for(var p=0;p<2;p++){var l=e[p];var a=this.borderStyles[l];n.save();n.beginPath();this.doSideClipSubPath(n,l);n.clip();this.drawBorderSides(n,1<<l);n.restore()}s.globalCompositeOpertation="source-over";s.drawImage(n.canvas,0,0,m.b.w,m.b.h,0,0,m.b.w,m.b.h)}s.restore()}var j=0;if(this.oneUnitBorder&&this.noBorderRadius){if(h){this.drawBorderSides(s,1|8);j|=1|8}if(q){this.drawBorderSides(s,4|2);j|=4|2}}for(var l=0;l<4;l++){if(j&(1<<l)){continue}if(this.borderWidths[l]==0||this.borderStyles[l]=="hidden"||this.borderStyles[l]=="none"){continue}s.save();s.beginPath();this.doSideClipWithoutCornersSubPath(s,l);s.clip();this.drawBorderSides(s,1<<l);s.restore()}}},computeInnerRadii:function(d,a){var e={};e[this.TOP_LEFT]=new th.Size2D(Math.max(0,d[this.TOP_LEFT].w-a[3]),Math.max(0,d[this.TOP_LEFT].h-a[0]));e[this.TOP_RIGHT]=new th.Size2D(Math.max(0,d[this.TOP_RIGHT].w-a[1]),Math.max(0,d[this.TOP_RIGHT].h-a[0]));e[this.BOTTOM_RIGHT]=new th.Size2D(Math.max(0,d[this.BOTTOM_RIGHT].w-a[1]),Math.max(0,d[this.BOTTOM_RIGHT].h-a[2]));e[this.BOTTOM_LEFT]=new th.Size2D(Math.max(0,d[this.BOTTOM_LEFT].w-a[3]),Math.max(0,d[this.BOTTOM_LEFT].h-a[2]));return e},copyRadii:function(d){var a={};for(c in d){a[c]=new th.Size2D(d[c])}return a},traceRoundRect:function(a,e,f,d){if(d){a.moveTo(e.x,e.y+f[this.TOP_LEFT].h);a.quadraticCurveTo(e.x,e.y,e.x+f[this.TOP_LEFT].w,e.y);a.lineTo(e.x+e.w-f[this.TOP_RIGHT].w,e.y);a.quadraticCurveTo(e.x+e.w,e.y,e.x+e.w,e.y+f[this.TOP_RIGHT].h);a.lineTo(e.x+e.w,e.y+e.h-f[this.BOTTOM_RIGHT].h);a.quadraticCurveTo(e.x+e.w,e.y+e.h,e.x+e.w-f[this.BOTTOM_RIGHT].w,e.y+e.h);a.lineTo(e.x+f[this.BOTTOM_LEFT].w,e.y+e.h);a.quadraticCurveTo(e.x,e.y+e.h,e.x,e.y+e.h-f[this.BOTTOM_LEFT].h);a.lineTo(e.x,e.y+f[this.TOP_LEFT].h)}else{a.moveTo(e.x,e.y+f[this.TOP_LEFT].h);a.lineTo(e.x,e.y+e.h-f[this.BOTTOM_LEFT].h);a.quadraticCurveTo(e.x,e.y+e.h,e.x+f[this.BOTTOM_LEFT].w,e.y+e.h);a.lineTo(e.x+e.w-f[this.BOTTOM_RIGHT].w,e.y+e.h);a.quadraticCurveTo(e.x+e.w,e.y+e.h,e.x+e.w,e.y+e.h-f[this.BOTTOM_RIGHT].h);a.lineTo(e.x+e.w,e.y+f[this.TOP_RIGHT].h);a.quadraticCurveTo(e.x+e.w,e.y,e.x+e.w-f[this.TOP_RIGHT].w,e.y);a.lineTo(e.x+f[this.TOP_LEFT].w,e.y);a.quadraticCurveTo(e.x,e.y,e.x,e.y+f[this.TOP_LEFT].h)}}}});th.Component=Class.define({type:"Component",uses:[th.ComponentHelpers],members:{init:function(a){if(!a){a={}}for(parm in a){this[parm]=a[parm]}if(!this.bounds){this.bounds={}}this.border=new th.SimpleBorder(this);if(this.opaque==undefined){this.opaque=true}this.bus=th.global_event_bus;this.styles=undefined;this.localStyles={};this.refreshCss=true},getScratchContext:function(){var a=this.getScene();if(a){return a.scratchContext}},getInsets:function(){var a=this.border.getInsets();this.calculateInsets("padding-","",a);return a},getMargins:function(){return this.calculateInsets("margin-")},paint:function(a){},repaint:function(){if(!this.getScene()){return}this.getScene().paint(this)}}});th.SimpleLayout=Class.define({members:{init:function(a){if(!a){a={}}this.orientation=a.orientation||th.HORIZONTAL},layout:function(f){var s=f.d();if(f.children.length>0){var q=(this.orientation==th.HORIZONTAL);var l=(q)?s.b.iw:s.b.ih;var j=parseInt(l/f.children.length);var t=l%f.children.length;var n=(q)?s.i.l:s.i.t;var o=n;for(var p=0;p<f.children.length;p++){var e=0;if(t>0){t--;e=1}var a=n;var m=j+e;f.children[p].bounds=(q)?{x:a,y:o,width:m,height:s.b.ih}:{x:o,y:a,width:s.b.ih,height:s.b.iw};n+=m}}},getMinimumSize:function(a,f){var h=(this.orientation==th.HORIZONTAL)?"width":"height";var e=0;for(var d=0;d<a.children.length;d++){e+=a.children[d].getMinimumSize()[h]}return e},getPreferredSize:function(a){var f=(this.orientation==th.HORIZONTAL)?"width":"height";var e=0;for(var d=0;d<a.children.length;d++){e+=a.children[d].getPreferredSize()[f]}return e},getMaximumSize:function(a){var f=(this.orientation==th.HORIZONTAL)?"width":"height";var e=0;for(var d=0;d<a.children.length;d++){e+=a.children[d].getMaximumSize()[f]}return e}}});th.Container=Class.define({type:"Container",superclass:th.Component,uses:[th.ContainerHelpers],members:{init:function(a){this._super(a);this.children=[];this.checkedForFormLayout=false;this.layoutManager=new th.SimpleLayout()},add:function(){for(var d=0;d<arguments.length;d++){component=th.isArray(arguments[d])?arguments[d]:[arguments[d]];this.children=this.children.concat(component);for(var a=0;a<component.length;a++){component[a].parent=this;component[a].refreshCss=true}}},remove:function(){for(var e=0;e<arguments.length;e++){component=th.isArray(arguments[e])?arguments[e]:[arguments[e]];for(var d=0;d<component.length;d++){var a=this.children.length;this.children=th.remove(this.children,component[d]);if(a!=this.children.length){delete component[d].parent}}}},replace:function(d,a){this.bus.unbind(this.children[a]);d.parent=this;this.children[a]=d},paint:function(a){if(this.shouldPaint()){this.paintSelf(a);this.paintChildren(a)}},paintSelf:function(a){},paintChildren:function(a){for(var f=0;f<this.children.length;f++){if(!this.children[f].shouldPaint()){continue}if(!this.children[f].bounds){continue}a.save();try{a.translate(this.children[f].bounds.x,this.children[f].bounds.y)}catch(d){a.restore();continue}try{a.beginPath();a.rect(0,0,this.children[f].bounds.width,this.children[f].bounds.height);a.closePath();a.clip()}catch(e){}a.save();this.children[f].paint(a);a.restore();if(this.children[f].border){a.save();this.children[f].border.paint(a);a.restore()}a.restore()}},installLayoutManager:function(e){this.layoutManager=e;var h=false;for(var d=0;d<this.children.length;d++){if(this.children[d]["constraints"]!==undefined){if(!this.children[d].cssValue("-th-constraints")){this.children[d].addCss("-th-constraints",this.children[d]["constraints"])}}if(this.children[d].cssValue("-th-constraints")){h=true}}if(e instanceof th.formlayout.FormLayout){if(!h){var f=1;var a=1;th.forEach(this.children,function(i){var m=false;while(f<=e.getRowCount()){while(a<=e.getColumnCount()){var l=e.getColumnSpec(a);if(l.isSpacer()){a++;continue}m=true;break}if(m){var j=e.getRowSpec(f);if(!j.isSpacer()){break}}m=false;f++;a=1}if(!m){return}e.addLayoutComponent(i,new th.formlayout.CellConstraints(a,f));a++})}else{th.forEach(this.children,function(i){var j=i.cssValue("-th-constraints");e.addLayoutComponent(i,new th.formlayout.CellConstraints(j))})}}},layoutTree:function(){if(!this.checkedForFormLayout){this.checkedForFormLayout=true;if(this.grid){var d=this.grid.split(";");if(d.length!=2){console.log("Couldn't parse 'grid' property: "+this.grid)}else{this.addCss("-th-grid-cols",d[0]);this.addCss("-th-grid-rows",d[1])}}var f=this.cssValue("-th-grid-cols");var e=this.cssValue("-th-grid-rows");if(f&&e){this.installLayoutManager(new th.formlayout.FormLayout(f,e))}}this.layout();for(var a=0;a<this.children.length;a++){if(this.children[a].layoutTree){this.children[a].layoutTree()}}},layout:function(){if(this.layoutManager){this.layoutManager.layout(this)}},render:function(){if(!th.global_resources.loaded){return}this.layoutTree();this.repaint()}}});th.Window=Class.define({type:"Window",members:{init:function(a){a=a||{};this.containerId=a.containerId||false;this.width=a.width||200;this.height=a.height||300;this.title=a.title||"NO TITLE GIVEN!";this.y=a.top||50;this.x=a.left||50;this.isVisible=false;this.closeOnClickOutside=!!a.closeOnClickOutside;if(!a.containerId){console.error('The "containerId" must be given!');return}if(th.byId(this.containerId)){console.error('There is already a element with the id "'+this.containerId+'"!');return}if(!a.userPanel){console.error('The "userPanel" must be given!');return}th.byId("popup_insert_point").innerHTML+='<div id="'+this.containerId+'" class="popupWindow"></div>';this.container=th.byId(this.containerId);dojo.attr(this.container,{width:this.width,height:this.height,tabindex:"-1"});this.container.innerHTML="<canvas id='"+this.containerId+"_canvas'></canvas>";this.canvas=th.byId(this.containerId+"_canvas");dojo.attr(this.canvas,{width:this.width,height:this.height,tabindex:"-1"});this.scene=new th.Scene(this.canvas);this.windowPanel=new th.components.WindowPanel(a.title,a.userPanel);this.windowPanel.windowBar.parentWindow=this;this.scene.root.add(this.windowPanel);this.move(this.x,this.y);dojo.connect(window,"mousedown",dojo.hitch(this,function(f){if(!this.isVisible||!this.closeOnClickOutside){return}var h=dojo.coords(this.container);if(f.clientX<h.l||f.clientX>(h.l+h.w)||f.clientY<h.t||f.clientY>(h.t+h.h)){this.toggle()}else{dojo.stopEvent(f)}}));dojo.connect(window,"keydown",dojo.hitch(this,function(d){if(!this.isVisible){return}if(d.keyCode==bespin.util.keys.Key.ESCAPE){this.toggle();dojo.stopEvent(d)}}))},toggle:function(){this.isVisible=!this.isVisible;if(this.isVisible){this.container.style.display="block";this.layoutAndRender()}else{this.container.style.display="none"}this.scene.bus.fire("toggle",{isVisible:this.isVisible},this)},layoutAndRender:function(){this.scene.layout();this.scene.render()},centerUp:function(){this.move(Math.round((window.innerWidth-this.width)*0.5),Math.round((window.innerHeight-this.height)*0.25))},center:function(){this.move(Math.round((window.innerWidth-this.width)*0.5),Math.round((window.innerHeight-this.height)*0.5))},move:function(a,d){this.y=d;this.x=a;this.container.style.top=d+"px";this.container.style.left=a+"px"},getPosition:function(){return{x:this.x,y:this.y}}}});if(typeof th=="undefined"){th={}}th.Panel=Class.define({type:"Panel",superclass:th.Container,members:{init:function(a){this._super(a)},paintSelf:function(a){this.paintBackground(a)}}});th.Button=Class.define({type:"Button",superclass:th.Component,members:{init:function(a){this._super(a)},paint:function(a){var h=this.d();var f=this.cssValue("-th-top-image");var e=this.cssValue("-th-middle-image");var i=this.cssValue("-th-bottom-image");if(f&&e&&i){if(h.b.h>=f.height+i.height){a.drawImage(f,0,0);if(h.b.h>f.height+i.height){a.drawImage(e,0,f.height,e.width,h.b.h-f.height-i.height)}a.drawImage(i,0,h.b.h-i.height)}}else{this.paintBackground(a)}}}});th.Scrollbar=Class.define({type:"Scrollbar",superclass:th.Container,members:{init:function(a){if(!a){a={}}this._super(a);this.orientation=a.orientation||th.VERTICAL;this.value=a.value||0;this.min=a.min||0;this.max=a.max||100;this.extent=a.extent||0.1;this.increment=a.increment||2;this.up=new th.Button({className:"up"});this.down=new th.Button({className:"down"});this.bar=new th.Button({className:"bar"});this.add([this.up,this.down,this.bar]);this.bus.bind("click",this.up,this.scrollup,this);this.bus.bind("click",this.down,this.scrolldown,this);this.bus.bind("mousedrag",this.bar,this.onmousedrag,this);this.bus.bind("mouseup",this.bar,this.onmouseup,this)},onmousedrag:function(i){var f=(this.orientation==th.VERTICAL)?i.clientY:i.clientX;if(this.dragstart_value==undefined){this.dragstart_value=this.value;this.dragstart_mouse=f;return}var h=f-this.dragstart_mouse;var a=this.bounds.height-this.up.bounds.height-this.down.bounds.height-this.bar.bounds.height;var d=(this.max-this.min)/a;this.value=this.dragstart_value+Math.floor(h*d);if(this.value<this.min){this.value=this.min}if(this.value>this.max){this.value=this.max}if(this.scrollable){this.scrollable.scrollTop=this.value}this.render();if(this.scrollable){this.scrollable.repaint()}},onmouseup:function(a){delete this.dragstart_value;delete this.dragstart_mouse},scrollup:function(a){if(this.value>this.min){this.value=Math.max(this.min,this.value-this.increment);if(this.scrollable){this.scrollable.scrollTop=this.value}this.render();if(this.scrollable){this.scrollable.repaint()}}},scrolldown:function(a){if(this.value<this.max){this.value=Math.min(this.max,this.value+this.increment);if(this.scrollable){this.scrollable.scrollTop=this.value}this.render();if(this.scrollable){this.scrollable.repaint()}}},layout:function(){var m=this.d();if(this.scrollable){var p=this.scrollable.bounds.height;var e=this.scrollable.getScrollInfo();this.min=0;this.max=e.scrollHeight-p;this.value=e.scrollTop;this.extent=(e.scrollHeight-p)/e.scrollHeight}if(this.max<this.min){for(var f=0;f<this.children.length;f++){delete this.children[f].bounds}return}if(this.orientation==th.VERTICAL){var n=m.b.iw;var j=12;this.up.bounds={x:m.i.l+1,y:m.i.t,width:n,height:j};this.down.bounds={x:m.i.l+1,y:m.b.ih-j,width:n,height:j};var o=m.b.ih-this.up.bounds.height-this.down.bounds.height;var l=Math.min(Math.floor(o-(this.extent*o),m.b.ih-this.up.bounds.height-this.down.bounds.height));var a=Math.floor(this.up.bounds.height+Math.min((this.value/(this.max-this.min))*(o-l)));this.bar.bounds={x:m.i.l+1,y:a,width:m.b.iw,height:l}}else{}},paint:function(a){if(this.max<0){return}var e=this.cssValue("-th-vertical-top-image");var d=this.cssValue("-th-vertical-middle-image");var f=this.cssValue("-th-vertical-bottom-image");if(e){a.drawImage(e,1,this.up.bounds.height)}if(d){a.drawImage(d,1,this.up.bounds.height+e.height,d.width,this.down.bounds.y-this.down.bounds.height-(this.up.bounds.x-this.up.bounds.height))}if(f){a.drawImage(f,1,this.down.bounds.y-f.height)}this._super(a)}}});th.ResizeNib=Class.define({type:"ResizeNib",superclass:th.Component,members:{init:function(a){this._super(a);this.bus.bind("mousedown",this,this.onmousedown,this);this.bus.bind("mouseup",this,this.onmouseup,this);this.bus.bind("mousedrag",this,this.onmousedrag,this)},onmousedown:function(a){this.startPos={x:a.clientX,y:a.clientY}},onmousedrag:function(a){if(this.startPos){if(!this.firedDragStart){this.bus.fire("dragstart",this.startPos,this);this.firedDragStart=true}this.bus.fire("drag",{startPos:this.startPos,currentPos:{x:a.clientX,y:a.clientY}},this)}},onmouseup:function(a){if(this.startPos&&this.firedDragStart){this.bus.fire("dragstop",{startPos:this.startPos,currentPos:{x:a.clientX,y:a.clientY}},this);delete this.firedDragStart}delete this.startPos},paint:function(p){var j=this.d();if(this.orientation==th.VERTICAL){var m=7;var o=Math.floor((j.b.w/2)-(m/2));var n=7;p.fillStyle=this.cssValue("-th-vertical-bar-shadow-color");for(var h=0;h<3;h++){p.fillRect(o,n,m,1);n+=3}n=8;p.fillStyle=this.cssValue("-th-vertical-bar-color");for(var h=0;h<3;h++){p.fillRect(o,n,m,1);n+=3}}else{var f=7;var a=8;var l=f+2;var o=Math.floor(j.b.w/2-(a/2));var n=Math.floor(j.b.h/2-(l/2));var e=o;if(this.cssValue("-th-horizontal-bar-subtle-shadow-color")){p.fillStyle=this.cssValue("-th-horizontal-bar-subtle-shadow-color");for(var h=0;h<3;h++){p.fillRect(e,n,1,l);e+=3}}e=o+1;p.fillStyle=this.cssValue("-th-horizontal-bar-shadow-color");for(var h=0;h<3;h++){p.fillRect(e,n+l-1,1,1);e+=3}e=o+1;p.fillStyle=this.cssValue("-th-horizontal-bar-color");for(var h=0;h<3;h++){p.fillRect(e,n+1,1,f);e+=3}}}}});th.Splitter=Class.define({type:"Splitter",superclass:th.Container,members:{init:function(a){this._super(a);this.topNib=new th.ResizeNib({orientation:this.orientation});this.bottomNib=new th.ResizeNib({orientation:this.orientation});this.add(this.topNib,this.bottomNib);this.label=a.label;if(this.label){this.add(this.label)}this.scrollbar=a.scrollbar;if(this.scrollbar){this.add(this.scrollbar)}this.bus.bind("drag",[this.topNib,this.bottomNib],this.ondrag,this);this.bus.bind("dragstart",[this.topNib,this.bottomNib],this.ondragstart,this);this.bus.bind("dragstop",[this.topNib,this.bottomNib],this.ondragstop,this)},ondrag:function(a){this.bus.fire("drag",a,this)},ondragstart:function(a){this.bus.fire("dragstart",a,this)},ondragstop:function(a){this.bus.fire("dragstop",a,this)},getPreferredSize:function(){return{height:20,width:16}},layout:function(){var a=this.d();if(!this.orientation){this.orientation=(this.bounds.height>this.bounds.width)?th.HORIZONTAL:th.VERTICAL}if(this.orientation==th.HORIZONTAL){this.topNib.bounds={x:0,y:0,height:a.b.w,width:a.b.w};this.bottomNib.bounds={x:0,y:this.bounds.height-a.b.w,height:a.b.w,width:a.b.w};if(this.scrollbar&&this.scrollbar.shouldLayout()){this.scrollbar.bounds={x:0,y:this.topNib.bounds.height,height:a.b.h-(this.topNib.bounds.height*2),width:a.b.w}}}else{this.topNib.bounds={x:0,y:0,height:a.b.h,width:a.b.h};this.bottomNib.bounds={x:a.b.w-a.b.h,y:0,height:a.b.h,width:a.b.h};if(this.label){this.label.bounds={x:this.topNib.bounds.x+this.topNib.bounds.width,y:0,height:a.b.h,width:a.b.w-(a.b.h*2)}}}},paintSelf:function(a){var f=this.d();if(this.orientation==th.VERTICAL){a.fillStyle="rgb(73, 72, 66)";a.fillRect(0,0,f.b.w,1);a.fillStyle="black";a.fillRect(0,f.b.h-1,f.b.w,1);var e=a.createLinearGradient(0,1,0,f.b.h-1);e.addColorStop(0,"rgb(50, 48, 42)");e.addColorStop(1,"rgb(22, 22, 19)");a.fillStyle=e;a.fillRect(0,1,f.b.w,f.b.h-2)}else{a.fillStyle="rgb(105, 105, 99)";a.fillRect(0,0,1,f.b.h);a.fillStyle="black";a.fillRect(f.b.w-1,0,1,f.b.h);var e=a.createLinearGradient(1,0,f.b.w-2,0);e.addColorStop(0,"rgb(56, 55, 49)");e.addColorStop(1,"rgb(62, 61, 55)");a.fillStyle=e;a.fillRect(1,0,f.b.w-2,f.b.h)}}}});th.SplitPanelContainer=Class.define({type:"SplitPanelContainer",superclass:th.Panel,members:{init:function(a){this._super(a);this.splitter=new th.Splitter({orientation:this.orientation,label:a.label})},getContents:function(){var a=th.remove(this.children,this.splitter);if(a.length>0){return a[0]}},layout:function(){var e=th.remove(this.children,this.splitter);if(this.children.length==e.length){this.add(this.splitter)}var d=this.splitter.getPreferredSize();var a=(this.orientation==th.HORIZONTAL)?d.width:d.height;if(this.splitter.shouldLayout()){if(this.orientation==th.HORIZONTAL){this.splitter.bounds={x:this.bounds.width-a,y:0,height:this.bounds.height,width:a}}else{this.splitter.bounds={x:0,y:this.bounds.height-a,height:a,width:this.bounds.width}}}else{a=0}if(e.length>0){if(this.orientation==th.HORIZONTAL){e[0].bounds={x:0,y:0,height:this.bounds.height,width:this.bounds.width-a}}else{e[0].bounds={x:0,y:0,height:this.bounds.height-a,width:this.bounds.width}}}}}});th.SplitPanel=Class.define({type:"SplitPanel",superclass:th.Panel,uses:[th.StringHelpers],members:{init:function(a){this._super(a);if(!this.orientation){this.orientation=th.HORIZONTAL}if(!this.regions){this.regions=[{},{}]}},ondragstart:function(d){var a=d.thComponent.parent;a.region.startSize=a.region.size},ondrag:function(d){var a=d.thComponent.parent;var f=(this.orientation==th.HORIZONTAL)?d.currentPos.x-d.startPos.x:d.currentPos.y-d.startPos.y;a.region.size=a.region.startSize+f;this.render()},ondragstop:function(d){var a=d.thComponent.parent;delete a.region.startSize},layout:function(){this.remove(this.children);for(var e=0;e<this.regions.length;e++){var l=this.regions[e];if(!l.container){l.container=new th.SplitPanelContainer({orientation:this.orientation,label:l.label});l.container.region=l;this.bus.bind("dragstart",l.container.splitter,this.ondragstart,this);this.bus.bind("drag",l.container.splitter,this.ondrag,this);this.bus.bind("dragstop",l.container.splitter,this.ondragstop,this)}if(l.contents&&(l.contents!=l.container.getContents())){l.container.removeAll();l.container.add(l.contents)}if(e==this.regions.length-1){l.container.splitter.addCss("display","none")}this.add(l.container)}var m=(this.orientation==th.HORIZONTAL)?this.bounds.width:this.bounds.height;var a=0;for(var e=0;e<this.regions.length;e++){var h=this.regions[e];if(!h.size){h.size=(this.defaultSize||(100/this.regions.length)+"%")}if(this.isPercentage(h.size)){h.size=Math.floor((parseInt(h.size)/100)*m)}if(h.size<30){h.size=30}a+=h.size}if(a>m){var j=a-m;for(var e=this.regions.length-1;e>=0;e--){var h=this.regions[e];var d=h.size;h.size-=j;if(h.size<30){h.size=30}j-=(d-h.size);if(j<=0){break}}}else{if(a<m){var h=this.regions[this.regions.length-1].size+=(m-a)}}var f=0;for(var e=0;e<this.regions.length;e++){var l=this.regions[e];if(this.orientation==th.HORIZONTAL){l.container.bounds={x:f,y:0,width:l.size,height:this.bounds.height}}else{l.container.bounds={x:0,y:f,width:this.bounds.width,height:l.size}}f+=l.size}}}});th.Label=Class.define({type:"Label",superclass:th.Panel,members:{init:function(a){if(!a){a={}}this._super(a);this.text=a.text||""},styleContext:function(a){if(!a){return}a.font=this.cssValue("font");a.fillStyle=this.cssValue("color");return a},getPreferredSize:function(){var d=this.styleContext(this.parent.getScratchContext());var a=d.measureText(this.text).width+2;a+=this.getInsets().left+this.getInsets().right;var e=Math.floor(d.measureText(this.text).ascent*1.5);e+=this.getInsets().top+this.getInsets().bottom;return{height:e,width:a}},paint:function(a){this._super(a);var l=this.d();this.styleContext(a);var h=a.measureText(this.text);var j=this.text;if(!j){j=""}var e=j.length-2;while(h.width>(l.b.w-l.i.w)){if(e==0){j="...";break}var i=Math.floor(e/2);var f=i+(e%2);j=this.text.substring(0,i)+"..."+this.text.substring(this.text.length-f);h=a.measureText(j);e-=1}var m=this.getInsets().top+h.ascent;if(th.browser.WebKit){m+=1}a.fillText(j,this.getInsets().left,m)}}});th.ExpandingInfoPanel=Class.define({type:"ExpandingInfoPanel",superclass:th.Panel,members:{init:function(a){this._super(a)},getMinimumRowHeight:function(){return 40},getMinimumColumnWidth:function(){},layout:function(){if(this.children.length==0){return}var p=this.d();var y=Math.floor(Math.sqrt(this.children.length));var x=Math.floor(p.b.h/y);while(x<this.getMinimumRowHeight()&&y>1){y--;x=Math.floor(p.b.h/y)}var u=Math.floor(this.children.length/y);var v=this.children.length%y;var l=0;var a=p.b.h%y;var f=0;for(var n=0;n<y;n++){var o=(n==y-1)?x+a:x;var s=(v>0)?u+1:u;v--;var e=Math.floor(p.b.w/s);var m=p.b.w%s;var j=0;for(var q=0;q<s;q++){var t=(q==s-1)?e+m:e;this.children[l++].bounds={x:j,y:f,width:t,height:o};j+=t}f+=o}}}});th.List=Class.define({type:"List",superclass:th.Container,members:{init:function(a){if(!a){a={}}this._super(a);this.items=a.items||[];this.scrollTop=0;this.allowDeselection=a.allowDeselection||false;this.bus.bind("mousedown",this,this.onmousedown,this);this.renderer=new th.Label();this.renderer.addCss("visibility","hidden");this.add(this.renderer);if(a.topLabel){this.addTopLabel(a.topLabel)}},addTopLabel:function(a){this.label=a;this.label.className="header";this.add(this.label)},onmousedown:function(d){var a=this.getItemForPosition({x:d.componentX,y:d.componentY});if(a!=this.selected){if(a){this.selected=a;this.bus.fire("itemselected",{container:this,item:this.selected},this);this.repaint()}else{if(this.allowDeselection){delete this.selected}}}},selectItemByText:function(e){if(this.items.length==0){return false}var d=null;if(th.isObject(this.items[0])){for(var a=0;a<this.items.length;a++){if(this.items[a].name==e){d=this.items[a];break}}if(d==null){return false}}else{if(this.items.indexOf(e)==-1){return false}d=this.items[this.items.indexOf(e)]}if(this.selected!=d){this.selected=d;this.repaint()}return true},moveSelectionUp:function(){if(!this.selected||this.items.length==0){return}var a=0;while(this.items[a]!=this.selected){a++}if(a!=0){this.selected=this.items[a-1];this.bus.fire("itemselected",{container:this,item:this.selected},this);this.repaint()}},moveSelectionDown:function(){if(!this.selected||this.items.length==0){return}var a=0;while(this.items[a]!=this.selected){a++}if(a!=this.items.length-1){this.selected=this.items[a+1];this.bus.fire("itemselected",{container:this,item:this.selected},this);this.repaint()}},getItemForPosition:function(f){f.y+=this.scrollTop;var e=this.getInsets().top;if(this.label){e+=this.label.bounds.height}for(var a=0;a<this.items.length;a++){var d=this.heights[a];if(f.y>=e&&f.y<=e+d){return this.items[a]}e+=d}},getRenderer:function(a){this.renderer.text=a.item.toString();this.renderer.selected=a.selected;this.renderer.pseudoClass=(this.renderer.selected)?"active":undefined;this.renderer.item=a.item;this.renderer.className=a.even?"even":"odd";if(a.item.contents){this.renderer.className+="more"}this.renderer.resolveCss();return this.renderer},getRenderContext:function(a,d){return{item:a,even:d%2==0,selected:this.selected==a}},getRowHeight:function(){if(!this.rowHeight){var f=this.d();var e=(this.items.length>0)?this.items[0]:undefined;if(e){var a=this.getRenderer(this.getRenderContext(e,0));this.rowHeight=a.getPreferredSize().height}}return this.rowHeight||0},getScrollInfo:function(){return{scrollTop:this.scrollTop,scrollHeight:this.getRowHeight()*this.items.length}},layout:function(){},paint:function(s){var n=this.d();var i=this.getScrollInfo();var j=Math.max(i.scrollHeight,n.b.h);var o=n.i.t;if(this.label){this.label.addCss("visibility","visible");var m=this.label.getPreferredSize().height;this.label.bounds={y:o,x:n.i.l,height:m,width:n.b.w};this.label.paint(s);this.label.border.paint(s);o+=m;this.label.addCss("visibility","hidden")}s.save();s.translate(0,-this.scrollTop);try{this.paintBackground(s,0,o,n.b.w,j);if(this.items.length==0){return}if(!this.renderer){console.log("No renderer for List of type "+this.type+" with id "+this.id+"; cannot paint contents");return}this.heights=[];var e=0;while(o<j){var f=(e<this.items.length);var q=f?this.items[e]:"";var a=this.getRenderer(this.getRenderContext(q,e));if(!a){break}var p=n.b.w-n.i.w;var l=(this.rowHeight)?this.rowHeight:(f)?a.getPreferredSize().height:this.heights[this.heights.length-1];if(f){this.heights.push(l)}if((o+l)>=this.scrollTop){a.bounds={x:0,y:0,height:l,width:p};s.save();s.translate(n.i.l,o);s.beginPath();s.rect(0,0,p,l);s.closePath();s.clip();a.addCss("visibility","visible");a.paint(s);a.border.paint(s);a.addCss("visibility","hidden");s.restore()}e++;o+=l}}finally{s.restore()}}}});th.HorizontalTree=Class.define({type:"HorizontalTree",superclass:th.Panel,members:{init:function(a){if(!a){a={}}this._super(a);this.orientation=th.HORIZONTAL;this.lists=[];this.splitters=[];this.listWidths=[]},setData:function(d){for(var a=0;a<this.lists.length;a++){this.remove(this.lists[a]);this.remove(this.splitters[a]);this.bus.unbind(this.lists[a]);this.bus.unbind(this.splitters[a])}this.lists=[];this.splitters=[];this.data=d;this.showChildren(null,d)},ondragstart:function(d){var a=this.splitters.indexOf(d.thComponent);this.startSize=this.listWidths[a]},ondrag:function(d){var a=this.splitters.indexOf(d.thComponent);var f=(this.orientation==th.HORIZONTAL)?d.currentPos.x-d.startPos.x:d.currentPos.y-d.startPos.y;this.listWidths[a]=this.startSize+f;this.render()},ondragstop:function(a){delete this.startSize},updateData:function(a,d){a.contents=d;if(this.getSelectedItem()==a){this.showChildren(a,a.contents)}},replaceList:function(a,d){this.lists[a].items=d;delete this.lists[a].selected;this.render()},removeListsFrom:function(d){for(var a=d;a<this.lists.length;a++){this.bus.unbind(this.lists[a]);this.bus.unbind(this.splitters[a]);this.remove(this.lists[a]);this.remove(this.splitters[a])}this.lists=this.lists.slice(0,d);this.splitters=this.splitters.slice(0,d)},showChildren:function(e,d){if(this.details){this.remove(this.details);delete this.details}if(!th.isArray(d)){d(this.getSelectedPath(),this);this.render();return}if(!d||d.length==0){return}var h=this.createList(d);if(this.id){h.id=this.id+"-list-"+(this.lists.length+1)}this.bus.bind("itemselected",h,this.itemSelected,this);var a=this;this.bus.bind("dblclick",h,function(i){a.bus.fire("dblclick",i,a)});this.lists.push(h);this.add(h);var f=new th.Splitter({orientation:th.HORIZONTAL,scrollbar:new th.Scrollbar()});f.scrollbar.scrollable=h;f.scrollbar.opaque=false;this.bus.bind("dragstart",f,this.ondragstart,this);this.bus.bind("drag",f,this.ondrag,this);this.bus.bind("dragstop",f,this.ondragstop,this);this.splitters.push(f);this.add(f);if(this.parent){this.render()}},showDetails:function(a){if(this.details){this.remove(this.details)}if(this.parent){this.repaint()}},createList:function(a){var d=new th.List({items:a});if(this.renderer){d.renderer=this.renderer}d.oldGetRenderer=d.getRenderer;d.getRenderer=function(e){var f=d.oldGetRenderer(e);f.text=e.item.name;return f};return d},getSelectedItem:function(){var a=this.getSelectedPath();if(a.length>0){return a[a.length-1]}},getSelectedPath:function(e){e=e||false;var f=[];for(var d=0;d<this.lists.length;d++){if(this.lists[d].selected){f.push(this.lists[d].selected)}else{break}}if(f.length==0){return}if(e){var a="";for(var d=0;d<f.length-1;d++){a+=f[d].name+"/"}if(!f[f.length-1].contents){a+=f[f.length-1].name}else{a+=f[f.length-1].name+"/"}return a}else{return f}return f},itemSelected:function(m){var n=m.thComponent;if(!n.selected){return}var p=[];for(var h=0;h<this.lists.length;h++){p.push(this.lists[h].selected);if(this.lists[h]==n){for(var f=h+1;f<this.lists.length&&this.lists[f].selected;f++){this.lists[f-1].selected.lastSelected=this.lists[f].selected.name;delete this.lists[f].selected}break}}this.bus.fire("itemselected",{e:m},this);if(p.length<this.lists.length){var d=this.lists.slice(0,p.length);var a=this.splitters.slice(0,p.length);for(var o=p.length;o<this.lists.length;o++){this.bus.unbind(this.lists[o]);this.bus.unbind(this.splitters[o]);this.remove(this.lists[o]);this.remove(this.splitters[o])}this.lists=d;this.splitters=a}var l=p[p.length-1];if(l&&l.contents){this.showChildren(l,l.contents)}else{this.showDetails(l)}},getItem:function(e){var a=this.data;var f;for(var d=0;d<e.length;d++){for(var h=0;h<a.length;h++){if(a[h]==e[d]){f=a[h];a=f.contents;break}}}return f},layout:function(){var l=this.d();var a=l.i.l;for(var f=0;f<this.lists.length;f++){var j=this.lists[f];if(!this.listWidths){this.listWidths=[]}if(!this.listWidths[f]){this.listWidths[f]=th.convertLengthToPixels(this.cssValue("-th-list-width"),this)}var e=this.listWidths[f];j.bounds={x:a,y:l.i.t,width:e,height:l.b.h-l.i.h};a+=e;var h=this.splitters[f];e=h.getPreferredSize().width;h.bounds={x:a,y:l.i.t,width:e,height:l.b.h-l.i.h};a+=e}if(this.details){this.details.bounds={x:a,y:l.i.t,width:th.convertLengthToPixels(this.cssValue("-th-default-width"),this),height:l.b.h-l.i.h}}},paintSelf:function(a){this._super(a)}}});th.DEFAULT_CSS="#root {/* this should probably be the browser's default font */font: 10pt Arial, sans-serif;}Scrollbar {-th-vertical-top-image: url(/images/dash_vscroll_track_top.png);-th-vertical-middle-image: url(/images/dash_vscroll_track_middle.png);-th-vertical-bottom-image: url(/images/dash_vscroll_track_bottom.png);}Scrollbar > Button.bar {-th-top-image: url(/images/dash_vscroll_top.png);-th-middle-image: url(/images/dash_vscroll_middle.png);-th-bottom-image: url(/images/dash_vscroll_bottom.png);}Scrollbar > Button.up {background-image: url(/images/dash_vscroll_up_arrow.png);}Scrollbar > Button.down {background-image: url(/images/dash_vscroll_down_arrow.png);}ResizeNib {-th-vertical-bar-color: rgb(10, 10, 8);-th-vertical-bar-shadow-color: rgb(185, 180, 158);-th-horizontal-bar-subtle-shadow-color: rgba(0, 0, 0, 0.1);-th-horizontal-bar-shadow-color: black;-th-horizontal-bar-color: rgb(183, 180, 160);}Label {padding: 2px 5px;}HorizontalTree {-th-list-width: 160px;-th-details-width: 150px;}";if(typeof th=="undefined"){th={}}th.Hashtable=(function(){function f(E){return(typeof E==="undefined")}function a(E){return(typeof E==="function")}function o(E){return(typeof E==="string")}function q(F,E){return a(F[E])}function A(E){return q(E,"equals")}function w(E){return q(E,"hashCode")}function C(F){if(o(F)){return F}else{if(w(F)){var E=F.hashCode();if(!o(E)){return C(E)}return E}else{if(q(F,"toString")){return F.toString()}else{return String(F)}}}}function z(E,F){return E.equals(F)}function h(E,F){if(A(F)){return F.equals(E)}else{return E===F}}function d(F,E){return F===E}function u(F,K,H,L,G){var J;for(var I=0,E=F.length;I<E;I++){J=F[I];if(G(K,H(J))){return L?[I,J]:true}}return false}function y(H,G){if(q(H,"splice")){H.splice(G,1)}else{if(G===H.length-1){H.length=G}else{var F=H.slice(G+1);H.length=G;for(var I=0,E=F.length;I<E;I++){H[G+I]=F[I]}}}}function D(F,E){if(F===null){throw new Error("null is not a valid "+E)}else{if(f(F)){throw new Error(E+" must not be undefined")}}}var m="key",e="value";function l(E){D(E,m)}function i(E){D(E,e)}function n(F,G,E){this.entries=[];this.addEntry(F,G);if(E!==null){this.getEqualityFunction=function(){return E}}}function B(E){return E[0]}function p(E){return E[1]}n.prototype={getEqualityFunction:function(E){if(A(E)){return z}else{return h}},searchForEntry:function(E){return u(this.entries,E,B,true,this.getEqualityFunction(E))},getEntryForKey:function(E){return this.searchForEntry(E)[1]},getEntryIndexForKey:function(E){return this.searchForEntry(E)[0]},removeEntryForKey:function(F){var E=this.searchForEntry(F);if(E){y(this.entries,E[0]);return true}return false},addEntry:function(E,F){this.entries[this.entries.length]=[E,F]},size:function(){return this.entries.length},keys:function(G){var H=G.length;for(var F=0,E=this.entries.length;F<E;F++){G[H+F]=this.entries[F][0]}},values:function(F){var H=F.length;for(var G=0,E=this.entries.length;G<E;G++){F[H+G]=this.entries[G][1]}},containsKey:function(E){return u(this.entries,E,B,false,this.getEqualityFunction(E))},containsValue:function(E){return u(this.entries,E,p,false,d)}};function x(){}x.prototype=[];function t(E){return E[0]}function j(G,E,F){return u(G,E,t,true,F)}function v(F,E){var G=F[E];if(G&&(G instanceof x)){return G[1]}return null}function s(G,F){var H=[];var E={};G=a(G)?G:C;F=a(F)?F:null;this.put=function(K,M){l(K);i(M);var I=G(K);var N=v(E,I);if(N){var J=N.getEntryForKey(K);if(J){J[1]=M}else{N.addEntry(K,M)}}else{var L=new x();L[0]=I;L[1]=new n(K,M,F);H[H.length]=L;E[I]=L}};this.get=function(K){l(K);var I=G(K);var L=v(E,I);if(L){var J=L.getEntryForKey(K);if(J){return J[1]}}return null};this.containsKey=function(J){l(J);var I=G(J);var K=v(E,I);if(K){return K.containsKey(J)}return false};this.containsValue=function(K){i(K);for(var J=0,I=H.length;J<I;J++){if(H[J][1].containsValue(K)){return true}}return false};this.clear=function(){H.length=0;E={}};this.isEmpty=function(){return H.length===0};this.keys=function(){var K=[];for(var J=0,I=H.length;J<I;J++){H[J][1].keys(K)}return K};this.values=function(){var J=[];for(var K=0,I=H.length;K<I;K++){H[K][1].values(J)}return J};this.remove=function(K){l(K);var J=G(K);var L=v(E,J);if(L){if(L.removeEntryForKey(K)){if(L.size()===0){var I=j(H,J,L.getEqualityFunction(K));y(H,I[0]);delete E[J]}}}};this.size=function(){var K=0;for(var J=0,I=H.length;J<I;J++){K+=H[J][1].size()}return K}}return s})();if(typeof th=="undefined"){th={}}if(typeof th.formlayout=="undefined"){th.formlayout={}}th.formlayout.Exception=Class.define({members:{init:function(a){this.message=a},toString:function(){return this.message}}});th.formlayout.IllegalArgumentException=Class.define({superclass:th.formlayout.Exception,members:{init:function(a){this._super(a)}}});th.formlayout.IndexOutOfBoundsException=Class.define({superclass:th.formlayout.Exception,members:{init:function(a){this._super(a)}}});th.formlayout.FormLayoutParseException=Class.define({superclass:th.formlayout.Exception,members:{init:function(a){this._super(a)}}});th.formlayout.Unit=Class.define({members:{init:function(a,f,e,d){this.name=a;this.abbreviation=f;this.parseAbbreviation=e;this.requiresIntegers=d},toString:function(){return this.name},encode:function(){return this.parseAbbreviation||this.abbreviation},abbreviation:function(){return this.abbreviation}}});th.formlayout.Unit.valueOf=function(e,d){if(e.length==0){var a=th.formlayout.Sizes.getDefaultUnit();if(a){return a}return d?th.formlayout.ConstantSize.DIALOG_UNITS_X:th.formlayout.ConstantSize.DIALOG_UNITS_Y}else{if(e=="px"){return th.formlayout.ConstantSize.PIXEL}else{if(e=="dlu"){return d?th.formlayout.ConstantSize.DIALOG_UNITS_X:th.formlayout.ConstantSize.DIALOG_UNITS_Y}else{if(e=="em"){return th.formlayout.ConstantSize.EM}else{if(e=="pt"){return th.formlayout.ConstantSize.POINT}else{if(e=="in"){return th.formlayout.ConstantSize.INCH}else{if(e=="mm"){return th.formlayout.ConstantSize.MILLIMETER}else{if(e=="cm"){return th.formlayout.ConstantSize.CENTIMETER}else{throw"Invalid unit name '"+e+"'. Must be one of: px, dlu, pt, mm, cm, in"}}}}}}}}};th.formlayout.FormLayout=Class.define({members:{init:function(e,d){if(th.isString(e)){e=th.formlayout.ColumnSpec.decodeSpecs(e)}if(th.isString(d)){d=th.formlayout.RowSpec.decodeSpecs(d)}this.colSpecs=e;this.rowSpecs=d;this.colGroupIndices=[];this.rowGroupIndices=[];this.constraintMap=new th.Hashtable();this.componentSizeCache=new th.formlayout.ComponentSizeCache();var a=this;this.minimumWidthMeasure=function(f){return a.componentSizeCache.getMinimumSize(f).width};this.minimumHeightMeasure=function(f){return a.componentSizeCache.getMinimumSize(f).height};this.preferredWidthMeasure=function(f){return a.componentSizeCache.getPreferredSize(f).width};this.preferredHeightMeasure=function(f){return a.componentSizeCache.getPreferredSize(f).height}},getColumnCount:function(){return this.colSpecs.length},getColumnSpec:function(a){return this.colSpecs[a-1]},setColumnSpec:function(d,a){this.colSpecs[d-1]=a},appendColumn:function(a){this.colSpecs.push(a)},insertColumn:function(d,a){if(d<1||d>this.getColumnCount()){throw"The column index "+d+"must be in the range [1, "+this.getColumnCount()+"]."}this.colSpecs[d-1]=a;this.shiftComponentsHorizontally(d,false);this.adjustGroupIndices(this.colGroupIndices,d,false)},removeColumn:function(a){if(a<1||a>this.getColumnCount()){throw"The column index "+a+" must be in the range [1, "+this.getColumnCount()+"]."}this.colSpecs.remove(a-1);this.shiftComponentsHorizontally(a,true);this.adjustGroupIndices(this.colGroupIndices,a,true)},getRowCount:function(){return this.rowSpecs.length},getRowSpec:function(a){return this.rowSpecs[a-1]},setRowSpec:function(d,a){this.rowSpecs[d-1]=a},appendRow:function(a){this.rowSpecs.push(a)},insertRow:function(d,a){if(d<1||d>this.getRowCount()){throw"The row index "+d+" must be in the range [1, "+this.getRowCount()+"]."}this.rowSpecs.add(d-1,a);this.shiftComponentsVertically(d,false);this.adjustGroupIndices(this.rowGroupIndices,d,false)},removeRow:function(a){if(a<1||a>this.getRowCount()){throw"The row index "+a+"must be in the range [1, "+this.getRowCount()+"]."}this.rowSpecs.remove(a-1);this.shiftComponentsVertically(a,true);this.adjustGroupIndices(this.rowGroupIndices,a,true)},shiftComponentsHorizontally:function(d,a){var f=a?-1:1;var e=this.constraintMap.keys();th.forEach(e,function(l){var m=this.constraintMap.get(l);var j=m.gridX;var h=m.gridWidth;var i=j+h-1;if(j==d&&a){throw"The removed column "+d+" must not contain component origins.\nIllegal component="+l}else{if(j>=d){m.gridX+=f}else{if(i>=d){m.gridWidth+=f}}}})},shiftComponentsVertically:function(f,a){var e=a?-1:1;var d=this.constraintMap.keys();th.forEach(d,function(j){var n=this.constraintMap.get(j);var m=n.gridY;var l=n.gridHeight;var i=m+l-1;if(m==f&&a){throw"The removed row "+f+" must not contain component origins.\nIllegal component="+j}else{if(m>=f){n.gridY+=e}else{if(i>=f){n.gridHeight+=e}}}})},adjustGroupIndices:function(h,d,a){var m=a?-1:+1;for(var j=0;j<h.length;j++){var l=h[j];for(var f=0;f<l.length;f++){var e=l[f];if(e==d&&a){throw"The removed index "+d+" must not be grouped."}else{if(e>=d){l[f]+=m}}}}},getConstraints:function(a){return this.constraintMap.get(a)},setConstraints:function(a,d){d.ensureValidGridBounds(this.getColumnCount(),this.getRowCount());this.constraintMap.put(a,d)},removeConstraints:function(a){this.constraintMap.remove(a);this.componentSizeCache.removeEntry(a)},getColumnGroups:function(){return this.colGroupIndices},setColumnGroups:function(h){var a=this.getColumnCount();var i=[];for(var f=0;f<this.colGroupIndices.length;f++){for(var e=0;e<this.colGroupIndices[f].length;e++){var d=this.colGroupIndices[f][e];if(d<1||d>a){throw"Invalid column group index "+d+" in group "+(f+1)}if(i[d]){throw"Column index "+d+" must not be used in multiple column groups."}i[d]=true}}this.colGroupIndices=h},addGroupedColumn:function(i){var f=this.getColumnGroups();if(f.length==0){f=[0][i]}else{var e=f.length-1;var h=f[e];var a=h.length;var d=h.slice(0,a);d[a]=i;f[e]=d}this.setColumnGroups(f)},getRowGroups:function(){return this.rowGroupIndices},setRowGroups:function(f){var a=this.getRowCount();var l=[];for(var e=0;e<this.rowGroupIndices.length;e++){for(var d=0;d<this.rowGroupIndices[e].length;d++){var h=this.rowGroupIndices[e][d];if(h<1||h>a){throw"Invalid row group index "+h+" in group "+(e+1)}if(l[h]){throw"Row index "+h+" must not be used in multiple row groups."}l[h]=true}}this.rowGroupIndices=f},addGroupedRow:function(i){var f=this.getRowGroups();if(f.length==0){f=[0][i]}else{var e=f.length-1;var h=f[e];var a=h.length;var d=h.slice(0,a);d[a]=i;f[e]=d}this.setRowGroups(f)},getHonorsVisibility:function(){return this.honorsVisibility},setHonorsVisibility:function(a){var h=this.getHonorsVisibility();if(h==a){return}this.honorsVisibility=a;var f=this.constraintMap.keys();if(f.length==0){return}var e=f[0];var d=e.parent;if(d){d.render()}},setHonorsVisibilityForComponent:function(d,a){var e=this.getConstraints(d);if(a==e.honorsVisibility){return}e.honorsVisibility=a;if(d.parent){d.parent.render()}},addLayoutComponent:function(a,d){if(th.isString(d)){this.setConstraints(a,new th.formlayout.CellConstraints(d))}else{this.setConstraints(a,d)}},removeLayoutComponent:function(a){this.removeConstraints(a)},getMinimumSize:function(a){return this.computeLayoutSize(a,this.minimumWidthMeasure,this.minimumHeightMeasure)},getPreferredSize:function(a){return this.computeLayoutSize(a,this.preferredWidthMeasure,this.preferredHeightMeasure)},getMaximumSize:function(a){return{width:1000000,height:1000000}},invalidateLayout:function(a){this.invalidateCaches()},layout:function(i){this.initializeColAndRowComponentLists();var h=i.getSize();var e=i.getInsets();var d=h.width-e.left-e.right;var f=h.height-e.top-e.bottom;var a=this.computeGridOrigins(i,d,e.left,this.colSpecs,this.colComponents,this.colGroupIndices,this.minimumWidthMeasure,this.preferredWidthMeasure);var j=this.computeGridOrigins(i,f,e.top,this.rowSpecs,this.rowComponents,this.rowGroupIndices,this.minimumHeightMeasure,this.preferredHeightMeasure);this.layoutComponents(a,j)},initializeColAndRowComponentLists:function(){this.colComponents=[];for(var a=0;a<this.getColumnCount();a++){this.colComponents[a]=[]}this.rowComponents=[];for(var a=0;a<this.getRowCount();a++){this.rowComponents[a]=[]}var d=this.constraintMap.keys();th.forEach(d,function(e){var f=this.constraintMap.get(e);if(this.takeIntoAccount(e,f)){if(f.gridWidth==1){this.colComponents[f.gridX-1].push(e)}if(f.gridHeight==1){this.rowComponents[f.gridY-1].push(e)}}},this)},computeLayoutSize:function(i,f,x){this.initializeColAndRowComponentLists();var y=this.maximumSizes(i,this.colSpecs,this.colComponents,this.minimumWidthMeasure,this.preferredWidthMeasure,f);var w=this.maximumSizes(i,this.rowSpecs,this.rowComponents,this.minimumHeightMeasure,this.preferredHeightMeasure,x);var s=this.groupedSizes(this.colGroupIndices,y);var o=this.groupedSizes(this.rowGroupIndices,w);var a=this.computeOrigins(s,0);var j=this.computeOrigins(o,0);var v=this.sum(s);var h=this.sum(o);var u=v;var q=h;var d=this.computeMaximumFixedSpanTable(this.colSpecs);var e=this.computeMaximumFixedSpanTable(this.rowSpecs);var l=this.constraintMap.keys();var n=this;th.forEach(l,function(H){var E=n.constraintMap.get(H);if(!n.takeIntoAccount(H,E)){return}if((E.gridWidth>1)&&(E.gridWidth>d[E.gridX-1])){var F=f(H);var D=E.gridX-1;var C=D+E.gridWidth;var G=a[D];var z=v-a[C];var B=G+F+z;if(B>u){u=B}}if((E.gridHeight>1)&&(E.gridHeight>e[E.gridY-1])){var K=x(H);var J=E.gridY-1;var I=J+E.gridHeight;var G=j[J];var z=h-j[I];var A=G+K+z;if(A>q){q=A}}});var t=i.getInsets();var p=u+t.left+t.right;var m=q+t.top+t.bottom;return{width:p,height:m}},computeGridOrigins:function(m,o,h,n,f,l,s,i){var w=this.maximumSizes(m,n,f,s,i,s);var d=this.maximumSizes(m,n,f,s,i,i);var t=this.groupedSizes(l,w);var v=this.groupedSizes(l,d);var u=this.sum(t);var q=this.sum(v);var j=this.compressedSizes(n,o,u,q,t,d);var p=this.groupedSizes(l,j);var e=this.sum(p);var a=this.distributedSizes(n,o,e,p);return this.computeOrigins(a,h)},computeOrigins:function(e,h){var d=e.length;var f=[];f[0]=h;for(var a=1;a<=d;a++){f[a]=f[a-1]+e[a-1]}return f},layoutComponents:function(a,e){var d=this.constraintMap.keys();th.forEach(d,function(h){var j={};var n=this.constraintMap.get(h);var f=n.gridX-1;var m=n.gridY-1;var l=n.gridWidth;var i=n.gridHeight;j.x=a[f];j.y=e[m];j.width=a[f+l]-j.x;j.height=e[m+i]-j.y;n.setBounds(h,this,j,this.minimumWidthMeasure,this.minimumHeightMeasure,this.preferredWidthMeasure,this.preferredHeightMeasure)},this)},invalidateCaches:function(){this.componentSizeCache.invalidate()},maximumSizes:function(a,h,l,d,j,f){var n=h.length;var o=[];for(var e=0;e<n;e++){var m=h[e];o[e]=m.maximumSize(a,l[e],d,j,f)}return o},compressedSizes:function(f,n,j,m,q,o){if(n<j){return q}if(n>=m){return o}var h=f.length;var s=[];var a=m-n;var p=m-j;var d=a/p;for(var e=0;e<h;e++){var l=f[e];s[e]=o[e];if(l.getSize().compressible()){s[e]-=Math.round((o[e]-q[e])*d)}}return s},groupedSizes:function(a,h){if(!a||a.length==0){return h}var f=[];for(var e=0;e<f.length;e++){f[e]=h[e]}for(var j=0;j<a.length;j++){var l=a[j];var m=0;for(var e=0;e<l.length;e++){var d=l[e]-1;m=Math.max(m,f[d])}for(var e=0;e<l.length;e++){var d=l[e]-1;f[d]=m}}return f},distributedSizes:function(m,u,t,f){var v=u-t;if(v<0){return f}var o=m.length;var e=0;for(var h=0;h<o;h++){var p=m[h];e+=p.getResizeWeight()}if(e==0){return f}var w=[];var d=v;var s=parseInt(v);for(var h=0;h<o;h++){var p=m[h];var l=p.getResizeWeight();if(l==th.formlayout.FormSpec.NO_GROW){w[h]=f[h]}else{var n=d-s;var a=v*l/e;var j=a-n;var q=Math.round(j);w[h]=f[h]+q;d-=a;s-=q}}return w},computeMaximumFixedSpanTable:function(j){var e=j.length;var f=[];var h=1000000;for(var d=e-1;d>=0;d--){var a=j[d];if(a.canGrow()){h=0}f[d]=h;if(h<1000000){h++}}return f},sum:function(e){var d=0;for(var a=e.length-1;a>=0;a--){d+=e[a]}return d},takeIntoAccount:function(a,d){return a.cssValue("visibility")!="hidden"||((!d.honorsVisibility)&&!this.getHonorsVisibility())||!d.honorsVisibility},getLayoutInfo:function(i){this.initializeColAndRowComponentLists();var h=i.getSize();var e=i.getInsets();var d=h.width-e.left-e.right;var f=h.height-e.top-e.bottom;var a=this.computeGridOrigins(i,d,e.left,this.colSpecs,this.colComponents,this.colGroupIndices,this.minimumWidthMeasure,this.preferredWidthMeasure);var j=this.computeGridOrigins(i,f,e.top,this.rowSpecs,this.rowComponents,this.rowGroupIndices,this.minimumHeightMeasure,this.preferredHeightMeasure);return new th.formlayout.LayoutInfo(a,j)}}});th.formlayout.LayoutInfo=Class.define({members:{init:function(d,a){this.columnOrigins=d;this.rowOrigins=a},getX:function(){return this.columnOrigins[0]},getY:function(){return this.rowOrigins[0]},getWidth:function(){return this.columnOrigins[this.columnOrigins.length-1]-this.columnOrigins[0]},getHeight:function(){return this.rowOrigins[this.rowOrigins.length-1]-this.rowOrigins[0]}}});th.formlayout.ComponentSizeCache=Class.define({members:{init:function(){this.minimumSizes=new th.Hashtable();this.preferredSizes=new th.Hashtable()},invalidate:function(){this.minimumSizes.clear();this.preferredSizes.clear()},getSize:function(a,f,e){var d=f.get(a);if(!d){d=a[e]();f.put(a,d)}return d},getMinimumSize:function(a){return this.getSize(a,this.minimumSizes,"getMinimumSize")},getPreferredSize:function(a){return this.getSize(a,this.preferredSizes,"getPreferredSize")},removeEntry:function(a){this.minimumSizes.remove(a);this.preferredSizes.remove(a)}}});th.formlayout.FormSpec=Class.define({members:{NO_GROW:0,DEFAULT_GROW:1,spacer:false,init:function(e,a,d){this.defaultAlignment=e;this.size=a;this.resizeWeight=d||0},isSpacer:function(){return this.spacer},getDefaultAlignment:function(){return this.defaultAlignment},getSize:function(){return this.size},getResizeWeight:function(){return this.resizeWeight},canGrow:function(){return this.resizeWeight!=this.NO_GROW},isHorizontal:function(){throw"This needs to be overridden."},setDefaultAlignment:function(a){this.defaultAlignment=a},setSize:function(a){this.size=a},setResizeWeight:function(a){this.resizeWeight=a},maximumSize:function(d,f,a,h,e){return this.size.maximumSize(d,f,a,h,e)},parseAndInitValues:function(f){if(f.indexOf("spacer(")==0){f=f.substring("spacer(".length,f.length-1);this.spacer=true}var d=f.split(":");if(d.length==0){throw new th.formlayout.IllegalArgumentException("The form spec must not be empty.")}var a=0;var e=d[a++];var h=th.formlayout.DefaultAlignment.valueOf(e,this.isHorizontal());if(h){this.setDefaultAlignment(h);if(d.length==1){throw new th.formlayout.IllegalArgumentException("The form spec must provide a size.")}e=d[a++]}this.setSize(this.parseSize(e));if(a<d.length){this.setResizeWeight(this.parseResizeWeight(d[a]))}},parseSize:function(a){if(a.indexOf("[")==0&&a.indexOf("]")==a.length-1){return this.parseBoundedSize(a)}if(a.indexOf("max(")==0&&a.indexOf(")")==a.length-1){return this.parseOldBoundedSize(a,false)}if(a.indexOf("min(")==0&&a.indexOf(")")==a.length-1){return this.parseOldBoundedSize(a,true)}return this.parseAtomicSize(a)},parseBoundedSize:function(d){var i=d.substring(1,d.length-1);var l=i.split(/\s*,\s*/);var j=undefined;var a=undefined;var f=undefined;if(l.length==2){var h=this.parseAtomicSize(l[0]);var e=this.parseAtomicSize(l[1]);if(this.isConstant(h)){if(this.isConstant(e)){a=h;j=e;f=e}else{a=h;j=e}}else{j=h;f=e}}else{if(l.length==3){a=this.parseAtomicSize(l[0]);j=this.parseAtomicSize(l[1]);f=this.parseAtomicSize(l[2])}}if(((a==null)||(this.isConstant(a)))&&((f==null)||(this.isConstant(f)))){return new th.formlayout.BoundedSize(j,a,f)}throw new th.formlayout.IllegalArgumentException("Illegal bounded size '"+d+"'. Must be one of:\n[<constant size>,<logical size>]                 // lower bound\n[<logical size>,<constant size>]                 // upper bound\n[<constant size>,<logical size>,<constant size>] // lower and upper bound.\nExamples:\n[50dlu,pref]                                     // lower bound\n[pref,200dlu]                                    // upper bound\n[50dlu,pref,200dlu]                              // lower and upper bound.")},parseAtomicSize:function(e){var a=th.trim(e);if(a.indexOf("'")==0&&a.indexOf("'")==a.length-1){var f=a.length;if(f<2){throw new th.formlayout.IllegalArgumentException('Missing closing "\'" for prototype.')}return new th.formlayout.PrototypeSize(a.substring(1,f-1))}var d=th.formlayout.ComponentSize.valueOf(a);if(d!=null){return d}return th.formlayout.ConstantSize.valueOf(a,this.isHorizontal())},parseResizeWeight:function(d){if(d=="g"||d=="grow"){return th.formlayout.FormSpec.DEFAULT_GROW}if(d=="n"||d=="nogrow"||d=="none"){return th.formlayout.FormSpec.NO_GROW}if((d.indexOf("grow(")==0||d.indexOf("g(")==0)&&d.indexOf(")")==d.length-1){var e=d.indexOf("(");var f=d.indexOf(")");var a=d.substring(e+1,f);return parseFloat(a)}throw new th.formlayout.IllegalArgumentException("The resize argument '"+d+"' is invalid.  Must be one of: grow, g, none, n, grow(<double>), g(<double>)")},isConstant:function(a){return(a instanceof th.formlayout.ConstantSize)||(a instanceof th.formlayout.PrototypeSize)},toString:function(){buffer=this.defaultAlignment;buffer+=":";buffer+=this.size.toString();buffer+=":";if(this.resizeWeight==th.formlayout.FormSpec.NO_GROW){buffer+="noGrow"}else{if(this.resizeWeight==th.formlayout.FormSpec.DEFAULT_GROW){buffer+="grow"}else{buffer+="grow(";buffer+=this.resizeWeight;buffer+=")"}}return buffer},toShortString:function(){buffer=this.defaultAlignment.abbreviation();buffer+=":";buffer+=this.size.toString();buffer+=":";if(this.resizeWeight==th.formlayout.FormSpec.NO_GROW){buffer+="n"}else{if(this.resizeWeight==th.formlayout.FormSpec.DEFAULT_GROW){buffer+="g"}else{buffer+="g(";buffer+=this.resizeWeight;buffer+=")"}}return buffer},encode:function(){var a="";var d=this.isHorizontal()?th.formlayout.ColumnSpec.DEFAULT:th.formlayout.RowSpec.DEFAULT;if(!d.equals(this.defaultAlignment)){a+=this.defaultAlignment.abbreviation();a+=":"}a+=this.size.encode();if(this.resizeWeight==th.formlayout.FormSpec.NO_GROW){}else{if(this.resizeWeight==th.formlayout.FormSpec.DEFAULT_GROW){a+=":";a+="g"}else{a+=":";a+="g(";a+=this.resizeWeight;a+=")"}}return a}}});th.formlayout.DefaultAlignment=Class.define({members:{init:function(a){this.name=a},toString:function(){return this.name},abbreviation:function(){return this.name.charAt(0)}}});th.formlayout.DefaultAlignment.valueOf=function(d,a){if(d=="f"||d=="fill"){return th.formlayout.FormSpec.FILL_ALIGN}else{if(d=="c"||d=="center"){return th.formlayout.FormSpec.CENTER_ALIGN}else{if(a){if(d=="r"||d=="right"){return th.formlayout.FormSpec.RIGHT_ALIGN}else{if(d=="l"||d=="left"){return th.formlayout.FormSpec.LEFT_ALIGN}else{return}}}else{if(d=="t"||d=="top"){return th.formlayout.FormSpec.TOP_ALIGN}else{if(d=="b"||d=="bottom"){return th.formlayout.FormSpec.BOTTOM_ALIGN}else{return}}}}}};th.formlayout.FormSpec.LEFT_ALIGN=new th.formlayout.DefaultAlignment("left");th.formlayout.FormSpec.RIGHT_ALIGN=new th.formlayout.DefaultAlignment("right");th.formlayout.FormSpec.TOP_ALIGN=new th.formlayout.DefaultAlignment("top");th.formlayout.FormSpec.BOTTOM_ALIGN=new th.formlayout.DefaultAlignment("bottom");th.formlayout.FormSpec.CENTER_ALIGN=new th.formlayout.DefaultAlignment("center");th.formlayout.FormSpec.FILL_ALIGN=new th.formlayout.DefaultAlignment("fill");th.formlayout.ColumnSpec=Class.define({superclass:th.formlayout.FormSpec,members:{init:function(e,a,d){this._super(e,a,d)},isHorizontal:function(){return true}}});th.formlayout.ColumnSpec.decode=function(a,f){var e=th.trim(a);var d=e.toLowerCase();return th.formlayout.ColumnSpec.decodeExpanded(d)};th.formlayout.ColumnSpec.decodeExpanded=function(d){var a=th.formlayout.ColumnSpec.CACHE.get(d);if(!a){a=new th.formlayout.ColumnSpec(th.formlayout.ColumnSpec.DEFAULT,th.formlayout.Sizes.DEFAULT,th.formlayout.FormSpec.NO_GROW);a.parseAndInitValues(d);th.formlayout.ColumnSpec.CACHE.put(d,a)}return a};th.formlayout.ColumnSpec.decodeSpecs=function(a,d){return th.formlayout.FormSpecParser.parseColumnSpecs(a,d)};th.formlayout.ColumnSpec.createGap=function(a){return new th.formlayout.RowSpec(th.formlayout.ColumnSpec.DEFAULT,a,th.formlayout.ColumnSpec.NO_GROW)};th.formlayout.ColumnSpec.LEFT=th.formlayout.FormSpec.LEFT_ALIGN;th.formlayout.ColumnSpec.CENTER=th.formlayout.FormSpec.CENTER_ALIGN;th.formlayout.ColumnSpec.MIDDLE=th.formlayout.ColumnSpec.CENTER;th.formlayout.ColumnSpec.RIGHT=th.formlayout.FormSpec.RIGHT_ALIGN;th.formlayout.ColumnSpec.FILL=th.formlayout.FormSpec.FILL_ALIGN;th.formlayout.ColumnSpec.DEFAULT=th.formlayout.ColumnSpec.FILL;th.formlayout.ColumnSpec.CACHE=new th.Hashtable();th.formlayout.RowSpec=Class.define({superclass:th.formlayout.FormSpec,members:{init:function(e,a,d){this._super(e,a,d)},isHorizontal:function(){return false}}});th.formlayout.RowSpec.decode=function(d,f){var e=th.trim(d);var a=e.toLowerCase();return th.formlayout.RowSpec.decodeExpanded(a)};th.formlayout.RowSpec.decodeExpanded=function(d){var a=th.formlayout.RowSpec.CACHE.get(d);if(!a){a=new th.formlayout.RowSpec(th.formlayout.RowSpec.DEFAULT,th.formlayout.Sizes.DEFAULT,th.formlayout.FormSpec.NO_GROW);a.parseAndInitValues(d);th.formlayout.RowSpec.CACHE.put(d,a)}return a};th.formlayout.RowSpec.decodeSpecs=function(a,d){return th.formlayout.FormSpecParser.parseRowSpecs(a,d)};th.formlayout.RowSpec.createGap=function(a){return new th.formlayout.RowSpec(th.formlayout.RowSpec.DEFAULT,a,th.formlayout.RowSpec.NO_GROW)};th.formlayout.RowSpec.TOP=th.formlayout.FormSpec.TOP_ALIGN;th.formlayout.RowSpec.CENTER=th.formlayout.FormSpec.CENTER_ALIGN;th.formlayout.RowSpec.BOTTOM=th.formlayout.FormSpec.BOTTOM_ALIGN;th.formlayout.RowSpec.FILL=th.formlayout.FormSpec.FILL_ALIGN;th.formlayout.RowSpec.DEFAULT=th.formlayout.RowSpec.CENTER;th.formlayout.RowSpec.CACHE=new th.Hashtable();th.formlayout.BoundedSize=Class.define({members:{init:function(d,e,a){this.basis=d;this.lowerBound=e;this.upperBound=a},getBasis:function(){return this.basis},getLowerBound:function(){return this.lowerBound},getUpperBound:function(){return this.upperBound},maximumSize:function(d,h,a,i,e){var f=this.basis.maximumSize(d,h,a,i,e);if(this.lowerBound){f=Math.max(f,this.lowerBound.maximumSize(d,h,a,i,e))}if(this.upperBound){f=Math.min(f,this.upperBound.maximumSize(d,h,a,i,e))}return f},compressible:function(){return this.basis.compressible()},equals:function(a){if(this===a){return true}var d=a;return this.basis.equals(d.basis)&&((this.lowerBound==null&&d.lowerBound==null)||(this.lowerBound!=null&&this.lowerBound.equals(d.lowerBound)))&&((this.upperBound==null&&d.upperBound==null)||(this.upperBound!=null&&this.upperBound.equals(d.upperBound)))},hashCode:function(){var a=this.basis.hashCode();if(this.lowerBound){a=a*37+this.lowerBound.hashCode()}if(this.upperBound){a=a*37+this.upperBound.hashCode()}return a}}});th.formlayout.ConstantSize=Class.define({members:{init:function(d,a){this.value=d;this.unit=a},getValue:function(){return this.value},getUnit:function(){return this.unit},getPixelSize:function(a){if(this.unit==th.formlayout.ConstantSize.PIXEL){return this.intValue()}else{if(this.unit==th.formlayout.ConstantSize.EM){return th.formlayout.Sizes.emAsPixel(this.value,a)}else{if(this.unit==th.formlayout.ConstantSize.POINT){return th.formlayout.Sizes.pointAsPixel(this.intValue(),a)}else{if(this.unit==th.formlayout.ConstantSize.INCH){return th.formlayout.Sizes.inchAsPixel(this.value,a)}else{if(this.unit==th.formlayout.ConstantSize.MILLIMETER){return th.formlayout.Sizes.millimeterAsPixel(this.value,a)}else{if(this.unit==th.formlayout.ConstantSize.CENTIMETER){return th.formlayout.Sizes.centimeterAsPixel(this.value,a)}else{if(this.unit==th.formlayout.ConstantSize.DIALOG_UNITS_X){return th.formlayout.Sizes.dialogUnitXAsPixel(this.intValue(),a)}else{if(this.unit==th.formlayout.ConstantSize.DIALOG_UNITS_Y){return th.formlayout.Sizes.dialogUnitYAsPixel(this.intValue(),a)}else{throw"Invalid unit "+this.unit}}}}}}}}},maximumSize:function(d,f,a,h,e){return this.getPixelSize(d)},compressible:function(){return false},equals:function(d){if(this==d){return true}if(!(d instanceof th.formlayout.ConstantSize)){return false}var a=d;return this.value==a.value&&this.unit==a.unit},hashCode:function(){return this.value+37*this.unit.hashCode()},toString:function(){return this.value+unit.abbreviation()},encode:function(){return this.value+unit.encode()},intValue:function(){return Math.round(this.value)}}});th.formlayout.ConstantSize.valueOf=function(j,a){var f=th.formlayout.ConstantSize.splitValueAndUnit(j);var e=f[0];var d=f[1];var h=th.formlayout.Unit.valueOf(d,a);var i=parseFloat(e);if(h.requiresIntegers){if(i!=parseInt(i)){throw h.toString()+" value "+e+" must be an integer."}}return new th.formlayout.ConstantSize(i,h)};th.formlayout.ConstantSize.dluX=function(a){return new th.formlayout.ConstantSize(a,th.formlayout.ConstantSize.DLUX)};th.formlayout.ConstantSize.dluY=function(a){return new th.formlayout.ConstantSize(a,th.formlayout.ConstantSize.DLUY)};th.formlayout.ConstantSize.splitValueAndUnit=function(f){var d=[];var a=f.length;var e=a;while(e>0&&(!/[^a-zA-Z]/.test(f.charAt(e-1)))){e--}d[0]=f.substring(0,e);d[1]=f.substring(e);return d};th.formlayout.ConstantSize.PIXEL=new th.formlayout.Unit("Pixel","px",undefined,true);th.formlayout.ConstantSize.EM=new th.formlayout.Unit("Em","em",undefined,false);th.formlayout.ConstantSize.POINT=new th.formlayout.Unit("Point","pt",undefined,false);th.formlayout.ConstantSize.DIALOG_UNITS_X=new th.formlayout.Unit("Dialog units X","dluX","dlu",true);th.formlayout.ConstantSize.DIALOG_UNITS_Y=new th.formlayout.Unit("Dialog units Y","dluY","dlu",true);th.formlayout.ConstantSize.MILLIMETER=new th.formlayout.Unit("Millimeter","mm",undefined,false);th.formlayout.ConstantSize.CENTIMETER=new th.formlayout.Unit("Centimeter","cm",undefined,false);th.formlayout.ConstantSize.INCH=new th.formlayout.Unit("Inch","in",undefined,false);th.formlayout.ConstantSize.PX=th.formlayout.ConstantSize.PIXEL;th.formlayout.ConstantSize.PT=th.formlayout.ConstantSize.POINT;th.formlayout.ConstantSize.DLUX=th.formlayout.ConstantSize.DIALOG_UNITS_X;th.formlayout.ConstantSize.DLUY=th.formlayout.ConstantSize.DIALOG_UNITS_Y;th.formlayout.ConstantSize.MM=th.formlayout.ConstantSize.MILLIMETER;th.formlayout.ConstantSize.CM=th.formlayout.ConstantSize.CENTIMETER;th.formlayout.ConstantSize.IN=th.formlayout.ConstantSize.INCH;th.formlayout.PrototypeSize=Class.define({members:{init:function(a){this.proto=a},getPrototype:function(){return this.proto},maximumSize:function(d,f,a,h,e){throw"PrototypeSize.maximumSize() not yet implemented"},compressible:function(){return false},encode:function(){return"'"+this.proto+"'"},equals:function(a){if(this==a){return true}if(!(a instanceof th.formlayout.PrototypeSize)){return false}return this.proto==a.proto},toString:function(){return this.encode()}}});th.formlayout.ComponentSize=Class.define({members:{init:function(a){this.name=a},maximumSize:function(d,m,e,l,j){var a=this==th.formlayout.Sizes.MINIMUM?e:(this==th.formlayout.Sizes.PREFERRED?l:j);var f=0;for(var h=0;h<m.length;h++){var n=m[h];f=Math.max(f,a(n))}return f},compressible:function(){return this==th.formlayout.Sizes.DEFAULT},toString:function(){return this.encode()},encode:function(){return name.substring(0,1)}}});th.formlayout.ComponentSize.valueOf=function(a){if(a=="m"||a=="min"){return th.formlayout.Sizes.MINIMUM}if(a=="p"||a=="pref"){return th.formlayout.Sizes.PREFERRED}if(a=="d"||a=="default"){return th.formlayout.Sizes.DEFAULT}return};th.formlayout.DefaultUnitConverter=Class.define({members:{inchAsPixel:function(d,a){return th.convertAbsoluteUnitToPixels("in",d)},millimeterAsPixel:function(d,a){return th.convertAbsoluteUnitToPixels("mm",d)},centimeterAsPixel:function(a,d){return th.convertAbsoluteUnitToPixels("cm",a)},pointAsPixel:function(d,a){return th.convertAbsoluteUnitToPixels("pt",d)},emAsPixel:function(d,a){return th.convertEmToPixels(a.cssValue("font"),d)},dialogUnitXAsPixel:function(d,a){throw"Unsupported"},dialogUnitYAsPixel:function(d,a){throw"Unsupported"}}});th.formlayout.Sizes={};th.formlayout.Sizes.unitConverter=new th.formlayout.DefaultUnitConverter();th.formlayout.Sizes.pixel=function(a){return new th.formlayout.ConstantSize(a,th.formlayout.ConstantSize.PIXEL)};th.formlayout.Sizes.ZERO=th.formlayout.Sizes.pixel(0);th.formlayout.Sizes.DLUX1=th.formlayout.ConstantSize.dluX(1);th.formlayout.Sizes.DLUX2=th.formlayout.ConstantSize.dluX(2);th.formlayout.Sizes.DLUX3=th.formlayout.ConstantSize.dluX(3);th.formlayout.Sizes.DLUX4=th.formlayout.ConstantSize.dluX(4);th.formlayout.Sizes.DLUX5=th.formlayout.ConstantSize.dluX(5);th.formlayout.Sizes.DLUX6=th.formlayout.ConstantSize.dluX(6);th.formlayout.Sizes.DLUX7=th.formlayout.ConstantSize.dluX(7);th.formlayout.Sizes.DLUX8=th.formlayout.ConstantSize.dluX(8);th.formlayout.Sizes.DLUX9=th.formlayout.ConstantSize.dluX(9);th.formlayout.Sizes.DLUX11=th.formlayout.ConstantSize.dluX(11);th.formlayout.Sizes.DLUX14=th.formlayout.ConstantSize.dluX(14);th.formlayout.Sizes.DLUX21=th.formlayout.ConstantSize.dluX(21);th.formlayout.Sizes.DLUY1=th.formlayout.ConstantSize.dluY(1);th.formlayout.Sizes.DLUY2=th.formlayout.ConstantSize.dluY(2);th.formlayout.Sizes.DLUY3=th.formlayout.ConstantSize.dluY(3);th.formlayout.Sizes.DLUY4=th.formlayout.ConstantSize.dluY(4);th.formlayout.Sizes.DLUY5=th.formlayout.ConstantSize.dluY(5);th.formlayout.Sizes.DLUY6=th.formlayout.ConstantSize.dluY(6);th.formlayout.Sizes.DLUY7=th.formlayout.ConstantSize.dluY(7);th.formlayout.Sizes.DLUY8=th.formlayout.ConstantSize.dluY(8);th.formlayout.Sizes.DLUY9=th.formlayout.ConstantSize.dluY(9);th.formlayout.Sizes.DLUY11=th.formlayout.ConstantSize.dluY(11);th.formlayout.Sizes.DLUY14=th.formlayout.ConstantSize.dluY(14);th.formlayout.Sizes.DLUY21=th.formlayout.ConstantSize.dluY(21);th.formlayout.Sizes.MINIMUM=new th.formlayout.ComponentSize("minimum");th.formlayout.Sizes.PREFERRED=new th.formlayout.ComponentSize("preferred");th.formlayout.Sizes.DEFAULT=new th.formlayout.ComponentSize("default");th.formlayout.Sizes.defaultUnit=th.formlayout.ConstantSize.PIXEL;th.formlayout.Sizes.constant=function(f,a){var d=f.toLowerCase();var e=th.trim(d);return th.formlayout.ConstantSize.valueOf(e,a)};th.formlayout.Sizes.bounded=function(d,e,a){return th.formlayout.BoundedSize(d,e,a)};th.formlayout.Sizes.emAsPixel=function(d,a){return d==0?0:th.formlayout.Sizes.unitConverter.emAsPixel(d,a)};th.formlayout.Sizes.inchAsPixel=function(d,a){return d==0?0:th.formlayout.Sizes.unitConverter.inchAsPixel(d,a)};th.formlayout.Sizes.millimeterAsPixel=function(d,a){return d==0?0:th.formlayout.Sizes.unitConverter.millimeterAsPixel(d,a)};th.formlayout.Sizes.centimeterAsPixel=function(a,d){return a==0?0:th.formlayout.Sizes.unitConverter.centimeterAsPixel(a,d)};th.formlayout.Sizes.pointAsPixel=function(d,a){return d==0?0:th.formlayout.Sizes.unitConverter.pointAsPixel(d,a)};th.formlayout.Sizes.dialogUnitXAsPixel=function(d,a){return d==0?0:th.formlayout.Sizes.unitConverter.dialogUnitXAsPixel(d,a)};th.formlayout.Sizes.dialogUnitYAsPixel=function(d,a){return d==0?0:th.formlayout.Sizes.unitConverter.dialogUnitYAsPixel(d,a)};th.formlayout.Sizes.getDefaultUnit=function(){return th.formlayout.Sizes.defaultUnit};th.formlayout.Alignment=Class.define({members:{init:function(d,a){this.name=d;this.orientation=a},toString:function(){return this.name},abbreviation:function(){return this.name.charAt(0)},isHorizontal:function(){return this.orientation!=th.formlayout.Alignment.VERTICAL},isVertical:function(){return this.orientation!=th.formlayout.Alignment.HORIZONTAL}}});th.formlayout.Alignment.HORIZONTAL=0;th.formlayout.Alignment.VERTICAL=1;th.formlayout.Alignment.BOTH=2;th.formlayout.Alignment.valueOf=function(a){var d=a.toLowerCase();if(d=="d"||d=="default"){return th.formlayout.CellConstraints.DEFAULT}else{if(d=="f"||d=="fill"){return th.formlayout.CellConstraints.FILL}else{if(d=="c"||d=="center"){return th.formlayout.CellConstraints.CENTER}else{if(d=="l"||d=="left"){return th.formlayout.CellConstraints.LEFT}else{if(d=="r"||d=="right"){return th.formlayout.CellConstraints.RIGHT}else{if(d=="t"||d=="top"){return th.formlayout.CellConstraints.TOP}else{if(d=="b"||d=="bottom"){return th.formlayout.CellConstraints.BOTTOM}else{throw"Invalid alignment "+a+". Must be one of: left, center, right, top, bottom, fill, default, l, c, r, t, b, f, d."}}}}}}}};th.formlayout.CellConstraints=Class.define({members:{init:function(d,l,i,h,f,j,e){var a=undefined;if(th.isString(d)){a=d;delete d}this.gridX=(d==undefined)?1:d;this.gridY=(l==undefined)?1:l;this.gridWidth=(i==undefined)?1:i;this.gridHeight=(h==undefined)?1:h;this.hAlign=f||th.formlayout.CellConstraints.DEFAULT;this.vAlign=j||th.formlayout.CellConstraints.DEFAULT;this.insets=e||th.formlayout.CellConstraints.EMPTY_INSETS;if(this.gridX<=0){throw new th.formlayout.IndexOutOfBoundsException("The grid x must be a positive number.")}if(this.gridY<=0){throw new th.formlayout.IndexOutOfBoundsException("The grid y must be a positive number.")}if(this.gridWidth<=0){throw new th.formlayout.IndexOutOfBoundsException("The grid width must be a positive number.")}if(this.gridHeight<=0){throw new th.formlayout.IndexOutOfBoundsException("The grid height must be a positive number.")}this.ensureValidOrientations(this.hAlign,this.vAlign);if(a){this.initFromConstraints(a)}},ensureValidOrientations:function(a,d){if(!a.isHorizontal()){throw new th.formlayout.IllegalArgumentException("The horizontal alignment must be one of: left, center, right, fill, default.")}if(!d.isVertical()){throw new th.formlayout.IllegalArgumentException("The vertical alignment must be one of: top, center, botto, fill, default.")}},initFromConstraints:function(a){var f=a.split(",");var i=f.length;if(!(i==2||i==4||i==6)){throw new th.formlayout.IllegalArgumentException("You must provide 2, 4 or 6 arguments.")}var d=0;var h=parseInt(th.trim(f[d++]));if(!h){throw new th.formlayout.IllegalArgumentException("First cell constraint element must be a number.")}this.gridX=h;if(this.gridX<=0){throw new th.formlayout.IndexOutOfBoundsException("The grid x must be a positive number.")}h=parseInt(th.trim(f[d++]));if(!h){throw new th.formlayout.IllegalArgumentException("Second cell constraint element must be a number.")}this.gridY=h;if(this.gridY<=0){throw new th.formlayout.IndexOutOfBoundsException("The grid y must be a positive number.")}if(d>=f.length){return}var e=th.trim(f[d++]);h=parseInt(e);if(h){this.gridWidth=h;if(this.gridWidth<=0){throw new th.formlayout.IndexOutOfBoundsException("The grid width must be a positive number.")}h=parseInt(th.trim(f[d++]));if(h==null){throw new th.formlayout.IllegalArgumentException("Fourth cell constraint element must be like third.")}this.gridHeight=h;if(this.gridHeight<=0){throw new th.formlayout.IndexOutOfBoundsException("The grid height must be a positive number.")}if(d>=f.length){return}e=th.trim(f[d++])}this.hAlign=this.decodeAlignment(e);this.vAlign=this.decodeAlignment(th.trim(f[d++]));this.ensureValidOrientations(this.hAlign,this.vAlign)},ensureValidGridBounds:function(d,a){if(this.gridX<=0){throw new th.formlayout.IndexOutOfBoundsException("The column index "+this.gridX+" must be positive.")}if(this.gridX>d){throw new th.formlayout.IndexOutOfBoundsException("The column index "+this.gridX+" must be less than or equal to "+d+".")}if(this.gridX+this.gridWidth-1>d){throw new th.formlayout.IndexOutOfBoundsException("The grid width "+this.gridWidth+" must be less than or equal to "+(d-this.gridX+1)+".")}if(this.gridY<=0){throw new th.formlayout.IndexOutOfBoundsException("The row index "+this.gridY+" must be positive.")}if(this.gridY>a){throw new th.formlayout.IndexOutOfBoundsException("The row index "+this.gridY+" must be less than or equal to "+a+".")}if(this.gridY+this.gridHeight-1>a){throw new th.formlayout.IndexOutOfBoundsException("The grid height "+this.gridHeight+" must be less than or equal to "+(a-this.gridY+1)+".")}},decodeAlignment:function(a){return th.formlayout.Alignment.valueOf(a)},setBounds:function(D,C,v,e,i,B,f){var E=this.gridWidth==1?C.getColumnSpec(this.gridX):undefined;var z=this.gridHeight==1?C.getRowSpec(this.gridY):undefined;var p=this.concreteAlignment(this.hAlign,E);var m=this.concreteAlignment(this.vAlign,z);var q=this.insets?this.insets:th.formlayout.CellConstraints.EMPTY_INSETS;var t=v.x+q.left;var s=v.y+q.top;var A=v.width-q.left-q.right;var a=v.height-q.top-q.bottom;var d=this.componentSize(D,E,A,e,B);var o=this.componentSize(D,z,a,i,f);var l=this.origin(p,t,A,d);var j=this.origin(m,s,a,o);var n=this.extent(p,A,d);var u=this.extent(m,a,o);D.setBounds(l,j,n,u)},concreteAlignment:function(a,d){return !d?(a==th.formlayout.CellConstraints.DEFAULT?th.formlayout.CellConstraints.FILL:a):this.usedAlignment(a,d)},usedAlignment:function(a,d){if(a!=th.formlayout.CellConstraints.DEFAULT){return a}var e=d.getDefaultAlignment();if(e==th.formlayout.FormSpec.FILL_ALIGN){return th.formlayout.CellConstraints.FILL}if(e==th.formlayout.ColumnSpec.LEFT){return th.formlayout.CellConstraints.LEFT}else{if(e==th.formlayout.FormSpec.CENTER_ALIGN){return th.formlayout.CellConstraints.CENTER}else{if(e==th.formlayout.ColumnSpec.RIGHT){return th.formlayout.CellConstraints.RIGHT}else{if(e==th.formlayout.RowSpec.TOP){return th.formlayout.CellConstraints.TOP}else{return th.formlayout.CellConstraints.BOTTOM}}}}},componentSize:function(e,d,h,a,f){if(!d){return f(e)}else{if(d.getSize()==th.formlayout.Sizes.MINIMUM){return a(e)}else{if(d.getSize()==th.formlayout.Sizes.PREFERRED){return f(e)}else{return Math.min(h,f(e))}}}},origin:function(f,d,e,a){if(f==th.formlayout.CellConstraints.RIGHT||f==th.formlayout.CellConstraints.BOTTOM){return d+e-a}else{if(f==th.formlayout.CellConstraints.CENTER){return d+(e-a)/2}else{return d}}},extent:function(e,d,a){return e==th.formlayout.CellConstraints.FILL?d:a},toString:function(){var a="CellConstraints";a+="[x=";a+=this.gridX;a+="; y=";a+=this.gridY;a+="; w=";a+=this.gridWidth;a+="; h=";a+=this.gridHeight;a+="; hAlign=";a+=this.hAlign;a+="; vAlign=";a+=this.vAlign;a+="; honorsVisibility=";a+=this.honorsVisibility;a+="]";return a},xy:function(){var a=arguments;switch(arguments.length){case 2:return this.xywh(a[0],a[1],1,1);case 3:return this.xywh(a[0],a[1],1,1,a[2]);case 4:return this.xywh(a[0],a[1],1,1,a[2],a[3]);default:throw"wrong number of arguments passed to xy()"}},xyw:function(){var a=arguments;switch(arguments.length){case 3:return this.xywh(a[0],a[1],a[2],1,th.formlayout.CellConstraints.DEFAULT,th.formlayout.CellConstraints.DEFAULT);case 4:return this.xywh(a[0],a[1],a[2],1,a[3]);case 5:return this.xywh(a[0],a[1],a[2],1,a[3],a[4]);default:throw"wrong number of arguments passed to xyw()"}},xywh:function(){var d=arguments;switch(arguments.length){case 4:return this.xywh(d[0],d[1],d[2],d[3],th.formlayout.CellConstraints.DEFAULT,th.formlayout.CellConstraints.DEFAULT);case 5:var a=this.xywh(d[0],d[1],d[2],d[3]);a.setAlignment(d[4],true);return a;case 6:this.gridX=d[0];this.gridY=d[1];this.gridWidth=d[2];this.gridHeight=d[3];this.hAlign=d[4];this.vAlign=d[5];this.ensureValidOrientations(this.hAlign,this.vAlign);return this;default:throw"wrong number of arguments passed to xywh()"}}}});th.formlayout.CellConstraints.DEFAULT=new th.formlayout.Alignment("default",th.formlayout.Alignment.BOTH);th.formlayout.CellConstraints.FILL=new th.formlayout.Alignment("fill",th.formlayout.Alignment.BOTH);th.formlayout.CellConstraints.LEFT=new th.formlayout.Alignment("left",th.formlayout.Alignment.HORIZONTAL);th.formlayout.CellConstraints.RIGHT=new th.formlayout.Alignment("right",th.formlayout.Alignment.HORIZONTAL);th.formlayout.CellConstraints.CENTER=new th.formlayout.Alignment("center",th.formlayout.Alignment.BOTH);th.formlayout.CellConstraints.TOP=new th.formlayout.Alignment("top",th.formlayout.Alignment.VERTICAL);th.formlayout.CellConstraints.BOTTOM=new th.formlayout.Alignment("bottom",th.formlayout.Alignment.VERTICAL);th.formlayout.CellConstraints.EMPTY_INSETS={top:0,left:0,bottom:0,right:0};th.formlayout.FormSpecParser=Class.define({members:{init:function(e,d,f,a){this.layoutMap=f;this.source=e},parseColumnSpecs:function(){var d=this.split(this.source,0);var f=d.length;var a=[];for(var e=0;e<f;e++){var h=d[e];a[e]=th.formlayout.ColumnSpec.decodeExpanded(h)}return a},parseRowSpecs:function(){var f=this.split(this.source,0);var a=f.length;var e=[];for(var d=0;d<a;d++){var h=f[d];e[d]=th.formlayout.RowSpec.decodeExpanded(h)}return e},split:function(j,f){var p=[];var d=0;var l=0;var a=j.length;var o=0;var n;var m=true;for(var h=0;h<a;h++){n=j.charAt(h);if(m&&th.isWhitespace(n)){o++;continue}m=false;if((n==",")&&(d==0)&&(l==0)){var e=j.substring(o,h);this.addSpec(p,e,f+o);o=h+1;m=true}else{if(n=="("){if(l>0){this.fail(f+h,"illegal '(' in [...]")}d++}else{if(n==")"){if(l>0){this.fail(f+h,"illegal ')' in [...]")}d--;if(d<0){this.fail(f+h,"missing '('")}}else{if(n=="["){if(l>0){this.fail(f+h,"too many '['")}l++}else{if(n=="]"){l--;if(l<0){this.fail(f+h,"missing '['")}}}}}}}if(d>0){this.fail(f+a,"missing ')'")}if(l>0){this.fail(f+a,"missing ']")}if(o<a){var e=j.substring(o);this.addSpec(p,e,f+o)}return p},addSpec:function(e,j,h){var d=th.trim(j);var l=this.multiplier(d,h);if(!l){e.push(d);return}var f=this.split(l.expression,h+l.offset);for(var a=0;a<l.multiplier;a++){th.forEach(f,function(i){e.push(i)})}},multiplier:function(j,h){var i=new RegExp(th.formlayout.FormSpecParser.MULTIPLIER_PREFIX_PATTERN);if(!i.test(j)){return}var d=i.exec(j);d.end=d.index+d[0].length;if(d.index>0){this.fail(h+d.index,"illegal multiplier position")}var a=new RegExp(th.formlayout.DIGIT_PATTERN);if(!a.test(j)){return}var m=a.exec(j);m.end=d.index+d[0].length;var l=j.substring(0,m.end);var e=parseInt(l);if(isNaN(e)){this.fail(h,"Invalid multiplier")}if(e<=0){this.fail(h,"illegal 0 multiplier")}var f=j.substring(d.end,j.length()-1);return{multiplier:e,expression:f,offset:d.end}},fail:function(a,d,e){if(!e){e=this.source}throw new th.formlayout.FormLayoutParseException(this.message(e,a,d))},message:function(h,d,f){var a="\n";a+="\n";a+=h;a+="\n";for(var e=0;e<d;e++){a+=" "}a+="^";a+=f;return a}}});th.formlayout.FormSpecParser.parseColumnSpecs=function(a,d){var e=new th.formlayout.FormSpecParser(a,"encoded column specifications",d,true);return e.parseColumnSpecs()};th.formlayout.FormSpecParser.parseRowSpecs=function(a,d){var e=new th.formlayout.FormSpecParser(a,"encoded column specifications",d,false);return e.parseRowSpecs()};th.formlayout.FormSpecParser.MULTIPLIER_PREFIX_PATTERN="\\d+\\s*\\*\\s*\\(";th.formlayout.FormSpecParser.DIGIT_PATTERN="\\d+";